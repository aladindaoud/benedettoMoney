(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5639],{1307:(it,Be,ve)=>{"use strict";ve.d(Be,{S:()=>be});var G=ve(177),me=ve(4341),te=ve(4742),U=ve(3953);let be=(()=>{var le;class Re{}return(le=Re).\u0275fac=function(ge){return new(ge||le)},le.\u0275mod=U.$C({type:le}),le.\u0275inj=U.G2t({imports:[G.MD,me.YN,te.bv]}),Re})()},3241:(it,Be,ve)=>{"use strict";ve.d(Be,{B:()=>La});var U,G=ve(467),me=ve(4844),te=ve.n(me),be=new Uint8Array(16);function le(){if(!U&&!(U=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return U(be)}const Re=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var _e=[],Pe=0;Pe<256;++Pe)_e.push((Pe+256).toString(16).substr(1));const Fe=function $e(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(_e[e[t+0]]+_e[e[t+1]]+_e[e[t+2]]+_e[e[t+3]]+"-"+_e[e[t+4]]+_e[e[t+5]]+"-"+_e[e[t+6]]+_e[e[t+7]]+"-"+_e[e[t+8]]+_e[e[t+9]]+"-"+_e[e[t+10]]+_e[e[t+11]]+_e[e[t+12]]+_e[e[t+13]]+_e[e[t+14]]+_e[e[t+15]]).toLowerCase();if(!function je(e){return"string"==typeof e&&Re.test(e)}(n))throw TypeError("Stringified UUID is invalid");return n},ce=function ze(e,t,n){var r=(e=e||{}).random||(e.rng||le)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(var i=0;i<16;++i)t[n+i]=r[i];return t}return Fe(r)};var k=ve(9186),O=ve(4356),v=ve.n(O),f=Function.prototype.toString,N=f.call(Object);function z(e){var t,n,r;if(!e||"object"!=typeof e)return e;if(Array.isArray(e)){for(t=[],n=0,r=e.length;n<r;n++)t[n]=z(e[n]);return t}if(e instanceof Date&&isFinite(e))return e.toISOString();if(function o(e){return typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer||typeof Blob<"u"&&e instanceof Blob}(e))return function c(e){return e instanceof ArrayBuffer?e.slice(0):e.slice(0,e.size,e.type)}(e);if(!function J(e){var t=Object.getPrototypeOf(e);if(null===t)return!0;var n=t.constructor;return"function"==typeof n&&n instanceof n&&f.call(n)==N}(e))return e;for(n in t={},e)if(Object.prototype.hasOwnProperty.call(e,n)){var i=z(e[n]);typeof i<"u"&&(t[n]=i)}return t}function ie(e){var t=!1;return function(...n){if(t)throw new Error("once called more than once");t=!0,e.apply(this,n)}}function Me(e){return function(...t){t=z(t);var n=this,r="function"==typeof t[t.length-1]&&t.pop(),i=new Promise(function(s,a){var u;try{var l=ie(function(w,b){w?a(w):s(b)});t.push(l),(u=e.apply(n,t))&&"function"==typeof u.then&&s(u)}catch(w){a(w)}});return r&&i.then(function(s){r(null,s)},r),i}}function Se(e,t){return Me(function(...n){if(this._closed)return Promise.reject(new Error("database is closed"));if(this._destroyed)return Promise.reject(new Error("database is destroyed"));var r=this;return function st(e,t,n){if(e.constructor.listeners("debug").length){for(var r=["api",e.name,t],i=0;i<n.length-1;i++)r.push(n[i]);e.constructor.emit("debug",r);var s=n[n.length-1];n[n.length-1]=function(a,u){var l=["api",e.name,t];l=l.concat(a?["error",a]:["success",u]),e.constructor.emit("debug",l),s(a,u)}}}(r,e,n),this.taskqueue.isReady?t.apply(this,n):new Promise(function(i,s){r.taskqueue.addTask(function(a){a?s(a):i(r[e].apply(r,n))})})})}function at(e,t){for(var n={},r=0,i=t.length;r<i;r++){var s=t[r];s in e&&(n[s]=e[s])}return n}var Kt,Gr=6;function Bn(e){return e}function Jr(e){return[{ok:e}]}function In(e,t,n){var r=t.docs,i=new Map;r.forEach(function(y){i.has(y.id)?i.get(y.id).push(y):i.set(y.id,[y])});var s=i.size,a=0,u=new Array(s);var E=[];i.forEach(function(y,d){E.push(d)});var T=0;!function g(){if(!(T>=E.length)){var y=Math.min(T+Gr,E.length),d=E.slice(T,y);(function m(y,d){y.forEach(function(_,A){var S=d+A,q=i.get(_),x=at(q[0],["atts_since","attachments"]);x.open_revs=q.map(function(L){return L.rev}),x.open_revs=x.open_revs.filter(Bn);var D=Bn;0===x.open_revs.length&&(delete x.open_revs,D=Jr),["revs","attachments","binary","ajax","latest"].forEach(function(L){L in t&&(x[L]=t[L])}),e.get(_,x,function(L,B){var P;P=L?[{error:L}]:D(B),function b(y,d,_){u[y]={id:d,docs:_},function w(){++a===s&&function l(){var y=[];u.forEach(function(d){d.docs.forEach(function(_){y.push({id:d.id,docs:[_]})})}),n(null,{results:y})}()}()}(S,_,P),g()})})})(d,T),T+=d.length}}()}try{localStorage.setItem("_pouch_check_localstorage",1),Kt=!!localStorage.getItem("_pouch_check_localstorage")}catch{Kt=!1}function qt(){return Kt}const Ze="function"==typeof queueMicrotask?queueMicrotask:function(t){Promise.resolve().then(t)};class zr extends(v()){constructor(){super(),this._listeners={},qt()&&addEventListener("storage",t=>{this.emit(t.key)})}addListener(t,n,r,i){if(!this._listeners[n]){var s=!1,a=this;this._listeners[n]=u,this.on(t,u)}function u(){if(a._listeners[n])if(s)s="waiting";else{s=!0;var l=at(i,["style","include_docs","attachments","conflicts","filter","doc_ids","view","since","query_params","binary","return_docs"]);r.changes(l).on("change",function(b){b.seq>i.since&&!i.cancelled&&(i.since=b.seq,i.onChange(b))}).on("complete",function(){"waiting"===s&&Ze(u),s=!1}).on("error",function w(){s=!1})}}}removeListener(t,n){n in this._listeners&&(super.removeListener(t,this._listeners[n]),delete this._listeners[n])}notifyLocalWindows(t){qt()&&(localStorage[t]="a"===localStorage[t]?"b":"a")}notify(t){this.emit(t),this.notifyLocalWindows(t)}}function Ke(e){if(typeof console<"u"&&"function"==typeof console[e]){var t=Array.prototype.slice.call(arguments,1);console[e].apply(console,t)}}function Wr(e){var t=0;return e||(t=2e3),function Qr(e,t){var n=6e5;return e=parseInt(e,10)||0,(t=parseInt(t,10))!=t||t<=e?t=(e||1)<<1:t+=1,t>n&&(e=n>>1,t=n),~~((t-e)*Math.random()+e)}(e,t)}function Ut(e,t){Ke("info","The above "+e+" is totally normal. "+t)}class Ae extends Error{constructor(t,n,r){super(),this.status=t,this.name=n,this.message=r,this.error=!0}toString(){return JSON.stringify({status:this.status,name:this.name,message:this.message,reason:this.reason})}}new Ae(401,"unauthorized","Name or password is incorrect.");var Hr=new Ae(400,"bad_request","Missing JSON list of 'docs'"),Ue=new Ae(404,"not_found","missing"),yt=new Ae(409,"conflict","Document update conflict"),jn=new Ae(400,"bad_request","_id field must contain a string"),Yr=new Ae(412,"missing_id","_id is required for puts"),Xr=new Ae(400,"bad_request","Only reserved document ids may start with underscore."),Gt=(new Ae(412,"precondition_failed","Database not open"),new Ae(500,"unknown_error","Database encountered an unknown error")),Nn=new Ae(500,"badarg","Some query argument is invalid"),Zr=(new Ae(400,"invalid_request","Request was invalid"),new Ae(400,"query_parse_error","Some query parameter is invalid")),$n=new Ae(500,"doc_validation","Bad special document member"),Dt=new Ae(400,"bad_request","Something wrong with the request"),Jt=new Ae(400,"bad_request","Document must be a JSON object"),zt=(new Ae(404,"not_found","Database not found"),new Ae(500,"indexed_db_went_bad","unknown")),kt=(new Ae(500,"web_sql_went_bad","unknown"),new Ae(500,"levelDB_went_went_bad","unknown"),new Ae(403,"forbidden","Forbidden by design doc validate_doc_update function"),new Ae(400,"bad_request","Invalid rev format")),Vr=(new Ae(412,"file_exists","The database could not be created, the file already exists."),new Ae(412,"missing_stub","A pre-existing attachment stub wasn't found"));function ee(e,t){function n(r){for(var i=Object.getOwnPropertyNames(e),s=0,a=i.length;s<a;s++)"function"!=typeof e[i[s]]&&(this[i[s]]=e[i[s]]);void 0===this.stack&&(this.stack=(new Error).stack),void 0!==r&&(this.reason=r)}return n.prototype=Ae.prototype,new n(t)}function mt(e){if("object"!=typeof e){var t=e;(e=Gt).data=t}return"error"in e&&"conflict"===e.error&&(e.name="conflict",e.status=409),"name"in e||(e.name=e.error||"unknown"),"status"in e||(e.status=500),"message"in e||(e.message=e.message||e.reason),"stack"in e||(e.stack=(new Error).stack),e}function Qt(e){var t={},n=e.filter&&"function"==typeof e.filter;return t.query=e.query_params,function(i){i.doc||(i.doc={});var s=n&&function ei(e,t,n){try{return!e(t,n)}catch(i){var r="Filter function threw: "+i.toString();return ee(Dt,r)}}(e.filter,i.doc,t);if("object"==typeof s)return s;if(s)return!1;if(e.include_docs){if(!e.attachments)for(var a in i.doc._attachments)Object.prototype.hasOwnProperty.call(i.doc._attachments,a)&&(i.doc._attachments[a].stub=!0)}else delete i.doc;return!0}}function Fn(e){var t;if(e?"string"!=typeof e?t=ee(jn):/^_/.test(e)&&!/^_(design|local)/.test(e)&&(t=ee(Xr)):t=ee(Yr),t)throw t}function Ve(e){return"boolean"==typeof e._remote?e._remote:"function"==typeof e.type&&(Ke("warn","db.type() is deprecated and will be removed in a future version of PouchDB"),"http"===e.type())}function Wt(e){if(!e)return null;var t=e.split("/");return 2===t.length?t:1===t.length?[e,e]:null}function Mn(e){var t=Wt(e);return t?t.join("/"):null}new Ae(413,"invalid_url","Provided URL is invalid");var Kn=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],Un="queryKey",ni=/(?:^|&)([^&=]*)=?([^&]*)/g,ri=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/;function Gn(e){for(var t=ri.exec(e),n={},r=14;r--;){var i=Kn[r],s=t[r]||"",a=-1!==["user","password"].indexOf(i);n[i]=a?decodeURIComponent(s):s}return n[Un]={},n[Kn[12]].replace(ni,function(u,l,w){l&&(n[Un][l]=w)}),n}function Ht(e,t){var n=[],r=[];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n.push(i),r.push(t[i]));return n.push(e),Function.apply(null,n).apply(null,r)}function Tt(e,t,n){return e.get(t).catch(function(r){if(404!==r.status)throw r;return{}}).then(function(r){var i=r._rev,s=n(r);return s?(s._id=t,s._rev=i,function ii(e,t,n){return e.put(t).then(function(r){return{updated:!0,rev:r.rev}},function(r){if(409!==r.status)throw r;return Tt(e,t._id,n)})}(e,s,n)):{updated:!1,rev:i}})}var Yt=function(e){return atob(e)},St=function(e){return btoa(e)};function Xt(e,t){e=e||[],t=t||{};try{return new Blob(e,t)}catch(s){if("TypeError"!==s.name)throw s;for(var r=new(typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder),i=0;i<e.length;i+=1)r.append(e[i]);return r.getBlob(t.type)}}function si(e){for(var t=e.length,n=new ArrayBuffer(t),r=new Uint8Array(n),i=0;i<t;i++)r[i]=e.charCodeAt(i);return n}function Zt(e,t){return Xt([si(e)],{type:t})}function Vt(e,t){return Zt(Yt(e),t)}function Jn(e,t){var n=new FileReader,r="function"==typeof n.readAsBinaryString;n.onloadend=function(i){var s=i.target.result||"";if(r)return t(s);t(function ai(e){for(var t="",n=new Uint8Array(e),r=n.byteLength,i=0;i<r;i++)t+=String.fromCharCode(n[i]);return t}(s))},r?n.readAsBinaryString(e):n.readAsArrayBuffer(e)}function zn(e,t){Jn(e,function(n){t(n)})}function en(e,t){zn(e,function(n){t(St(n))})}var ui=self.setImmediate||self.setTimeout,ci=32768;function li(e,t,n,r,i){(n>0||r<t.size)&&(t=t.slice(n,r)),function oi(e,t){var n=new FileReader;n.onloadend=function(r){var i=r.target.result||new ArrayBuffer(0);t(i)},n.readAsArrayBuffer(e)}(t,function(s){e.append(s),i()})}function di(e,t,n,r,i){(n>0||r<t.length)&&(t=t.substring(n,r)),e.appendBinary(t),i()}function tn(e,t){var n="string"==typeof e,r=n?e.length:e.size,i=Math.min(ci,r),s=Math.ceil(r/i),a=0,u=n?new(te()):new(te().ArrayBuffer),l=n?di:li;function w(){ui(E)}function b(){var g=function fi(e){return St(e)}(u.end(!0));t(g),u.destroy()}function E(){var T=a*i;a++,l(u,e,T,T+i,a<s?w:b)}E()}function Qn(e){return te().hash(e)}function Wn(e,t){if(!t)return ce().replace(/-/g,"").toLowerCase();var n=Object.assign({},e);return delete n._rev_tree,Qn(JSON.stringify(n))}var Rt=ce;function ot(e){for(var t,n,r,s,i=e.rev_tree.slice();s=i.pop();){var a=s.ids,u=a[2],l=s.pos;if(u.length)for(var w=0,b=u.length;w<b;w++)i.push({pos:l+1,ids:u[w]});else{var E=!!a[1].deleted,T=a[0];(!t||(r!==E?r:n!==l?n<l:t<T))&&(t=T,n=l,r=E)}}return n+"-"+t}function ut(e,t){for(var r,n=e.slice();r=n.pop();)for(var i=r.pos,s=r.ids,a=s[2],u=t(0===a.length,i,s[0],r.ctx,s[1]),l=0,w=a.length;l<w;l++)n.push({pos:i+1,ids:a[l],ctx:u})}function hi(e,t){return e.pos-t.pos}function nn(e){var t=[];ut(e,function(i,s,a,u,l){i&&t.push({rev:s+"-"+a,pos:s,opts:l})}),t.sort(hi).reverse();for(var n=0,r=t.length;n<r;n++)delete t[n].pos;return t}function rn(e){for(var t=ot(e),n=nn(e.rev_tree),r=[],i=0,s=n.length;i<s;i++){var a=n[i];a.rev!==t&&!a.opts.deleted&&r.push(a.rev)}return r}function Hn(e){for(var r,t=[],n=e.slice();r=n.pop();){var i=r.pos,s=r.ids,a=s[0],u=s[1],l=s[2],w=0===l.length,b=r.history?r.history.slice():[];b.push({id:a,opts:u}),w&&t.push({pos:i+1-b.length,ids:b});for(var E=0,T=l.length;E<T;E++)n.push({pos:i+1,ids:l[E],history:b})}return t.reverse()}function gi(e,t){return e.pos-t.pos}function yi(e,t,n){var r=function pi(e,t,n){for(var s,r=0,i=e.length;r<i;)n(e[s=r+i>>>1],t)<0?r=s+1:i=s;return r}(e,t,n);e.splice(r,0,t)}function Yn(e,t){for(var n,r,i=t,s=e.length;i<s;i++){var a=e[i],u=[a.id,a.opts,[]];r?(r[2].push(u),r=u):n=r=u}return n}function mi(e,t){return e[0]<t[0]?-1:1}function Xn(e,t){for(var n=[{tree1:e,tree2:t}],r=!1;n.length>0;){var i=n.pop(),s=i.tree1,a=i.tree2;(s[1].status||a[1].status)&&(s[1].status="available"===s[1].status||"available"===a[1].status?"available":"missing");for(var u=0;u<a[2].length;u++)if(s[2][0]){for(var l=!1,w=0;w<s[2].length;w++)s[2][w][0]===a[2][u][0]&&(n.push({tree1:s[2][w],tree2:a[2][u]}),l=!0);l||(r="new_branch",yi(s[2],a[2][u],mi))}else r="new_leaf",s[2][0]=a[2][u]}return{conflicts:r,tree:e}}function Zn(e,t,n){var a,r=[],i=!1,s=!1;if(!e.length)return{tree:[t],conflicts:"new_leaf"};for(var u=0,l=e.length;u<l;u++){var w=e[u];if(w.pos===t.pos&&w.ids[0]===t.ids[0])a=Xn(w.ids,t.ids),r.push({pos:w.pos,ids:a.tree}),i=i||a.conflicts,s=!0;else if(!0!==n){var b=w.pos<t.pos?w:t,E=w.pos<t.pos?t:w,g=[],m=[];for(m.push({ids:b.ids,diff:E.pos-b.pos,parent:null,parentIdx:null});m.length>0;){var y=m.pop();if(0!==y.diff)for(var d=y.ids[2],_=0,A=d.length;_<A;_++)m.push({ids:d[_],diff:y.diff-1,parent:y.ids,parentIdx:_});else y.ids[0]===E.ids[0]&&g.push(y)}var S=g[0];S?(a=Xn(S.ids,E.ids),S.parent[2][S.parentIdx]=a.tree,r.push({pos:b.pos,ids:b.ids}),i=i||a.conflicts,s=!0):r.push(w)}else r.push(w)}return s||r.push(t),r.sort(gi),{tree:r,conflicts:i||"internal_node"}}function Vn(e,t,n){var r=Zn(e,t),i=function wi(e,t){for(var r,i,n=Hn(e),s=0,a=n.length;s<a;s++){var w,u=n[s],l=u.ids;if(l.length>t){r||(r={});var b=l.length-t;w={pos:u.pos+b,ids:Yn(l,b)};for(var E=0;E<b;E++)r[u.pos+E+"-"+l[E].id]=!0}else w={pos:u.pos,ids:Yn(l,0)};i=i?Zn(i,w,!0).tree:[w]}return r&&ut(i,function(g,m,y){delete r[m+"-"+y]}),{tree:i,revs:r?Object.keys(r):[]}}(r.tree,n);return{tree:i.tree,stemmedRevs:i.revs,conflicts:r.conflicts}}function Ai(e){return e.ids}function nt(e,t){t||(t=ot(e));for(var i,n=t.substring(t.indexOf("-")+1),r=e.rev_tree.map(Ai);i=r.pop();){if(i[0]===n)return!!i[1].deleted;r=r.concat(i[2])}}function ct(e){return"string"==typeof e&&e.startsWith("_local/")}function Ci(e,t,n){var r=[{rev:e._rev}];"all_docs"===n.style&&(r=nn(t.rev_tree).map(function(s){return{rev:s.rev}}));var i={id:t.id,changes:r,doc:e};return nt(t,e._rev)&&(i.deleted=!0),n.conflicts&&(i.doc._conflicts=rn(t),i.doc._conflicts.length||delete i.doc._conflicts),i}class Oi extends(v()){constructor(t,n,r){super(),this.db=t;var i=(n=n?z(n):{}).complete=ie((u,l)=>{u?function ti(e,t){return"listenerCount"in e?e.listenerCount(t):v().listenerCount(e,t)}(this,"error")>0&&this.emit("error",u):this.emit("complete",l),this.removeAllListeners(),t.removeListener("destroyed",s)});r&&(this.on("complete",function(u){r(null,u)}),this.on("error",r));const s=()=>{this.cancel()};t.once("destroyed",s),n.onChange=(u,l,w)=>{this.isCancelled||function xi(e,t,n,r){try{e.emit("change",t,n,r)}catch(i){Ke("error",'Error in .on("change", function):',i)}}(this,u,l,w)};var a=new Promise(function(u,l){n.complete=function(w,b){w?l(w):u(b)}});this.once("cancel",function(){t.removeListener("destroyed",s),n.complete(null,{status:"cancelled"})}),this.then=a.then.bind(a),this.catch=a.catch.bind(a),this.then(function(u){i(null,u)},i),t.taskqueue.isReady?this.validateChanges(n):t.taskqueue.addTask(u=>{u?n.complete(u):this.isCancelled?this.emit("cancel"):this.validateChanges(n)})}cancel(){this.isCancelled=!0,this.db.taskqueue.isReady&&this.emit("cancel")}validateChanges(t){var n=t.complete;ne._changesFilterPlugin?ne._changesFilterPlugin.validate(t,r=>{if(r)return n(r);this.doChanges(t)}):this.doChanges(t)}doChanges(t){var n=t.complete;if("live"in(t=z(t))&&!("continuous"in t)&&(t.continuous=t.live),t.processChange=Ci,"latest"===t.since&&(t.since="now"),t.since||(t.since=0),"now"!==t.since){if(ne._changesFilterPlugin){if(ne._changesFilterPlugin.normalize(t),ne._changesFilterPlugin.shouldFilter(this,t))return ne._changesFilterPlugin.filter(this,t)}else["doc_ids","filter","selector","view"].forEach(function(i){i in t&&Ke("warn",'The "'+i+'" option was passed in to changes/replicate, but pouchdb-changes-filter plugin is not installed, so it was ignored. Please install the plugin to enable filtering.')});"descending"in t||(t.descending=!1),t.limit=0===t.limit?1:t.limit,t.complete=n;var r=this.db._changes(t);if(r&&"function"==typeof r.cancel){const i=this.cancel;this.cancel=(...s)=>{r.cancel(),i.apply(this,s)}}}else this.db.info().then(i=>{this.isCancelled?n(null,{status:"cancelled"}):(t.since=i.update_seq,this.doChanges(t))},n)}}function sn(e,t){return function(n,r){n||r[0]&&r[0].error?((n=n||r[0]).docId=t,e(n)):e(null,r.length?r[0]:r)}}function qi(e,t){return e._id===t._id?(e._revisions?e._revisions.start:0)-(t._revisions?t._revisions.start:0):e._id<t._id?-1:1}function er(e){var t=e._compactionQueue[0],n=t.opts,r=t.callback;e.get("_local/compaction").catch(function(){return!1}).then(function(i){i&&i.last_seq&&(n.last_seq=i.last_seq),e._compact(n,function(s,a){s?r(s):r(null,a),Ze(function(){e._compactionQueue.shift(),e._compactionQueue.length&&er(e)})})})}function an(e){return null===e||"object"!=typeof e||Array.isArray(e)}const Pi=/^\d+-[^-]*$/;function on(e){return"string"==typeof e&&Pi.test(e)}class tr extends(v()){_setup(){this.post=Se("post",function(t,n,r){if("function"==typeof n&&(r=n,n={}),an(t))return r(ee(Jt));this.bulkDocs({docs:[t]},n,sn(r,t._id))}).bind(this),this.put=Se("put",function(t,n,r){if("function"==typeof n&&(r=n,n={}),an(t))return r(ee(Jt));if(Fn(t._id),"_rev"in t&&!on(t._rev))return r(ee(kt));if(ct(t._id)&&"function"==typeof this._putLocal)return t._deleted?this._removeLocal(t,r):this._putLocal(t,r);const i=a=>{"function"==typeof this._put&&!1!==n.new_edits?this._put(t,n,a):this.bulkDocs({docs:[t]},n,sn(a,t._id))};n.force&&t._rev?(function s(){var a=t._rev.split("-"),u=a[1],w=parseInt(a[0],10)+1,b=Wn();t._revisions={start:w,ids:[b,u]},t._rev=w+"-"+b,n.new_edits=!1}(),i(function(a){r(a,a?null:{ok:!0,id:t._id,rev:t._rev})})):i(r)}).bind(this),this.putAttachment=Se("putAttachment",function(t,n,r,i,s){var a=this;function u(l){var w="_rev"in l?parseInt(l._rev,10):0;return l._attachments=l._attachments||{},l._attachments[n]={content_type:s,data:i,revpos:++w},a.put(l)}return"function"==typeof s&&(s=i,i=r,r=null),typeof s>"u"&&(s=i,i=r,r=null),s||Ke("warn","Attachment",n,"on document",t,"is missing content_type"),a.get(t).then(function(l){if(l._rev!==r)throw ee(yt);return u(l)},function(l){if(l.reason===Ue.message)return u({_id:t});throw l})}).bind(this),this.removeAttachment=Se("removeAttachment",function(t,n,r,i){this.get(t,(s,a)=>{if(s)i(s);else{if(a._rev===r)return a._attachments?(delete a._attachments[n],0===Object.keys(a._attachments).length&&delete a._attachments,void this.put(a,i)):i();i(ee(yt))}})}).bind(this),this.remove=Se("remove",function(t,n,r,i){var s;"string"==typeof n?(s={_id:t,_rev:n},"function"==typeof r&&(i=r,r={})):(s=t,"function"==typeof n?(i=n,r={}):(i=r,r=n)),(r=r||{}).was_delete=!0;var a={_id:s._id,_rev:s._rev||r.rev,_deleted:!0};if(ct(a._id)&&"function"==typeof this._removeLocal)return this._removeLocal(s,i);this.bulkDocs({docs:[a]},r,sn(i,a._id))}).bind(this),this.revsDiff=Se("revsDiff",function(t,n,r){"function"==typeof n&&(r=n,n={});var i=Object.keys(t);if(!i.length)return r(null,{});var s=0,a=new Map;function u(w,b){a.has(w)||a.set(w,{missing:[]}),a.get(w).missing.push(b)}i.forEach(function(w){this._getRevisionTree(w,function(b,E){if(b&&404===b.status&&"missing"===b.message)a.set(w,{missing:t[w]});else{if(b)return r(b);!function l(w,b){var E=t[w].slice(0);ut(b,function(T,g,m,y,d){var _=g+"-"+m,A=E.indexOf(_);-1!==A&&(E.splice(A,1),"available"!==d.status&&u(w,_))}),E.forEach(function(T){u(w,T)})}(w,E)}if(++s===i.length){var T={};return a.forEach(function(g,m){T[m]=g}),r(null,T)}})},this)}).bind(this),this.bulkGet=Se("bulkGet",function(t,n){In(this,t,n)}).bind(this),this.compactDocument=Se("compactDocument",function(t,n,r){this._getRevisionTree(t,(i,s)=>{if(i)return r(i);var a=function Di(e){var t={},n=[];return ut(e,function(r,i,s,a){var u=i+"-"+s;return r&&(t[u]=0),void 0!==a&&n.push({from:a,to:u}),u}),n.reverse(),n.forEach(function(r){t[r.from]=void 0===t[r.from]?1+t[r.to]:Math.min(t[r.from],1+t[r.to])}),t}(s),u=[],l=[];Object.keys(a).forEach(function(w){a[w]>n&&u.push(w)}),ut(s,function(w,b,E,T,g){var m=b+"-"+E;"available"===g.status&&-1!==u.indexOf(m)&&l.push(m)}),this._doCompaction(t,l,r)})}).bind(this),this.compact=Se("compact",function(t,n){"function"==typeof t&&(n=t,t={}),t=t||{},this._compactionQueue=this._compactionQueue||[],this._compactionQueue.push({opts:t,callback:n}),1===this._compactionQueue.length&&er(this)}).bind(this),this.get=Se("get",function(t,n,r){if("function"==typeof n&&(r=n,n={}),n=n||{},"string"!=typeof t)return r(ee(jn));if(ct(t)&&"function"==typeof this._getLocal)return this._getLocal(t,r);var i=[];const s=()=>{var l=[],w=i.length;if(!w)return r(null,l);i.forEach(b=>{this.get(t,{rev:b,revs:n.revs,latest:n.latest,attachments:n.attachments,binary:n.binary},function(E,T){if(E)l.push({missing:b});else{for(var g,m=0,y=l.length;m<y;m++)if(l[m].ok&&l[m].ok._rev===T._rev){g=!0;break}g||l.push({ok:T})}--w||r(null,l)})})};if(!n.open_revs)return this._get(t,n,(l,w)=>{if(l)return l.docId=t,r(l);var b=w.doc,E=w.metadata,T=w.ctx;if(n.conflicts){var g=rn(E);g.length&&(b._conflicts=g)}if(nt(E,b._rev)&&(b._deleted=!0),n.revs||n.revs_info){for(var m=b._rev.split("-"),y=parseInt(m[0],10),d=m[1],_=Hn(E.rev_tree),A=null,S=0;S<_.length;S++){var q=_[S];const F=q.ids.findIndex(M=>M.id===d);(F===y-1||!A&&-1!==F)&&(A=q)}if(!A)return(l=new Error("invalid rev tree")).docId=t,r(l);const I=b._rev.split("-")[1],V=A.ids.findIndex(F=>F.id===I)+1;if(A.ids.splice(V,A.ids.length-V),A.ids.reverse(),n.revs&&(b._revisions={start:A.pos+A.ids.length-1,ids:A.ids.map(function(F){return F.id})}),n.revs_info){var L=A.pos+A.ids.length;b._revs_info=A.ids.map(function(F){return{rev:--L+"-"+F.id,status:F.opts.status}})}}if(n.attachments&&b._attachments){var B=b._attachments,P=Object.keys(B).length;if(0===P)return r(null,b);Object.keys(B).forEach(I=>{this._getAttachment(b._id,I,B[I],{binary:n.binary,metadata:E,ctx:T},function(V,F){var M=b._attachments[I];M.data=F,delete M.stub,delete M.length,--P||r(null,b)})})}else{if(b._attachments)for(var $ in b._attachments)Object.prototype.hasOwnProperty.call(b._attachments,$)&&(b._attachments[$].stub=!0);r(null,b)}});if("all"===n.open_revs)this._getRevisionTree(t,function(l,w){if(l)return r(l);i=nn(w).map(function(b){return b.rev}),s()});else{if(!Array.isArray(n.open_revs))return r(ee(Gt,"function_clause"));i=n.open_revs;for(var a=0;a<i.length;a++)if(!on(i[a]))return r(ee(kt));s()}}).bind(this),this.getAttachment=Se("getAttachment",function(t,n,r,i){r instanceof Function&&(i=r,r={}),this._get(t,r,(s,a)=>s?i(s):a.doc._attachments&&a.doc._attachments[n]?(r.ctx=a.ctx,r.binary=!0,r.metadata=a.metadata,void this._getAttachment(t,n,a.doc._attachments[n],r,i)):i(ee(Ue)))}).bind(this),this.allDocs=Se("allDocs",function(t,n){if("function"==typeof t&&(n=t,t={}),t.skip=typeof t.skip<"u"?t.skip:0,t.start_key&&(t.startkey=t.start_key),t.end_key&&(t.endkey=t.end_key),"keys"in t){if(!Array.isArray(t.keys))return n(new TypeError("options.keys must be an array"));var r=["startkey","endkey","key"].filter(function(i){return i in t})[0];if(r)return void n(ee(Zr,"Query parameter `"+r+"` is not compatible with multi-get"));if(!Ve(this)&&(function ki(e){var t="limit"in e?e.keys.slice(e.skip,e.limit+e.skip):e.skip>0?e.keys.slice(e.skip):e.keys;e.keys=t,e.skip=0,delete e.limit,e.descending&&(t.reverse(),e.descending=!1)}(t),0===t.keys.length))return this._allDocs({limit:0},n)}return this._allDocs(t,n)}).bind(this),this.close=Se("close",function(t){return this._closed=!0,this.emit("closed"),this._close(t)}).bind(this),this.info=Se("info",function(t){this._info((n,r)=>{if(n)return t(n);r.db_name=r.db_name||this.name,r.auto_compaction=!(!this.auto_compaction||Ve(this)),r.adapter=this.adapter,t(null,r)})}).bind(this),this.id=Se("id",function(t){return this._id(t)}).bind(this),this.bulkDocs=Se("bulkDocs",function(t,n,r){if("function"==typeof n&&(r=n,n={}),n=n||{},Array.isArray(t)&&(t={docs:t}),!t||!t.docs||!Array.isArray(t.docs))return r(ee(Hr));for(var i=0;i<t.docs.length;++i){const l=t.docs[i];if(an(l))return r(ee(Jt));if("_rev"in l&&!on(l._rev))return r(ee(kt))}var s;if(t.docs.forEach(function(l){l._attachments&&Object.keys(l._attachments).forEach(function(w){s=s||function Ri(e){return"_"===e.charAt(0)&&e+" is not a valid attachment name, attachment names cannot start with '_'"}(w),l._attachments[w].content_type||Ke("warn","Attachment",w,"on document",l._id,"is missing content_type")})}),s)return r(ee(Dt,s));"new_edits"in n||(n.new_edits=!("new_edits"in t)||t.new_edits);var a=this;!n.new_edits&&!Ve(a)&&t.docs.sort(qi),function Ei(e){for(var t=0;t<e.length;t++){var n=e[t];if(n._deleted)delete n._attachments;else if(n._attachments)for(var r=Object.keys(n._attachments),i=0;i<r.length;i++){var s=r[i];n._attachments[s]=at(n._attachments[s],["data","digest","content_type","length","revpos","stub"])}}}(t.docs);var u=t.docs.map(function(l){return l._id});this._bulkDocs(t,n,function(l,w){if(l)return r(l);if(n.new_edits||(w=w.filter(function(T){return T.error})),!Ve(a))for(var b=0,E=w.length;b<E;b++)w[b].id=w[b].id||u[b];r(null,w)})}).bind(this),this.registerDependentDatabase=Se("registerDependentDatabase",function(t,n){var r=z(this.__opts);this.__opts.view_adapter&&(r.adapter=this.__opts.view_adapter);var i=new this.constructor(t,r);Tt(this,"_local/_pouch_dependentDbs",function s(a){return a.dependentDbs=a.dependentDbs||{},!a.dependentDbs[t]&&(a.dependentDbs[t]=!0,a)}).then(function(){n(null,{db:i})}).catch(n)}).bind(this),this.destroy=Se("destroy",function(t,n){"function"==typeof t&&(n=t,t={});var r=!("use_prefix"in this)||this.use_prefix;const i=()=>{this._destroy(t,(s,a)=>{if(s)return n(s);this._destroyed=!0,this.emit("destroyed"),n(null,a||{ok:!0})})};if(Ve(this))return i();this.get("_local/_pouch_dependentDbs",(s,a)=>{if(s)return 404!==s.status?n(s):i();var l=this.constructor,w=Object.keys(a.dependentDbs).map(b=>{var E=r?b.replace(new RegExp("^"+l.prefix),""):b;return new l(E,this.__opts).destroy()});Promise.all(w).then(i,n)})}).bind(this)}_compact(t,n){var s,r={return_docs:!1,last_seq:t.last_seq||0,since:t.last_seq||0},i=[],a=0;const u=b=>{this.activeTasks.update(s,{completed_items:++a}),i.push(this.compactDocument(b.id,0))},l=b=>{this.activeTasks.remove(s,b),n(b)},w=b=>{var E=b.last_seq;Promise.all(i).then(()=>Tt(this,"_local/compaction",T=>(!T.last_seq||T.last_seq<E)&&(T.last_seq=E,T))).then(()=>{this.activeTasks.remove(s),n(null,{ok:!0})}).catch(l)};this.info().then(b=>{s=this.activeTasks.add({name:"database_compaction",total_items:b.update_seq-r.last_seq}),this.changes(r).on("change",u).on("complete",w).on("error",l)})}changes(t,n){return"function"==typeof t&&(n=t,t={}),(t=t||{}).return_docs="return_docs"in t?t.return_docs:!t.live,new Oi(this,t,n)}type(){return"function"==typeof this._type?this._type():this.adapter}}tr.prototype.purge=Se("_purge",function(e,t,n){if(typeof this._purge>"u")return n(ee(Gt,"Purge is not implemented in the "+this.adapter+" adapter."));var r=this;r._getRevisionTree(e,(i,s)=>{if(i)return n(i);if(!s)return n(ee(Ue));let a;try{a=function _i(e,t){let n=[];const r=e.slice();let i;for(;i=r.pop();){const{pos:s,ids:a}=i,u=`${s}-${a[0]}`,l=a[2];if(n.push(u),u===t){if(0!==l.length)throw new Error("The requested revision is not a leaf");return n.reverse()}(0===l.length||l.length>1)&&(n=[]);for(let w=0,b=l.length;w<b;w++)r.push({pos:s+1,ids:l[w]})}if(0===n.length)throw new Error("The requested revision does not exist");return n.reverse()}(s,t)}catch(u){return n(u.message||u)}r._purge(e,a,(u,l)=>{if(u)return n(u);(function Ti(e,t,n){return e.get("_local/purges").then(function(r){const i=r.purgeSeq+1;return r.purges.push({docId:t,rev:n,purgeSeq:i}),r.purges.length>self.purged_infos_limit&&r.purges.splice(0,r.purges.length-self.purged_infos_limit),r.purgeSeq=i,r}).catch(function(r){if(404!==r.status)throw r;return{_id:"_local/purges",purges:[{docId:t,rev:n,purgeSeq:0}],purgeSeq:0}}).then(function(r){return e.put(r)})})(r,e,t).then(function(){return n(null,l)})})})});class Li{constructor(){this.isReady=!1,this.failed=!1,this.queue=[]}execute(){var t;if(this.failed)for(;t=this.queue.shift();)t(this.failed);else for(;t=this.queue.shift();)t()}fail(t){this.failed=t,this.execute()}ready(t){this.isReady=!0,this.db=t,this.execute()}addTask(t){this.queue.push(t),this.failed&&this.execute()}}function nr(e,t){let n=function(...r){if(!(this instanceof n))return new n(...r);t.apply(this,r)};return function Ii(e,t){e.prototype=Object.create(t.prototype,{constructor:{value:e}})}(n,e),n}class rr extends tr{constructor(t,n){super(),this._setup(t,n)}_setup(t,n){if(super._setup(),n=n||{},t&&"object"==typeof t&&(t=(n=t).name,delete n.name),void 0===n.deterministic_revs&&(n.deterministic_revs=!0),this.__opts=n=z(n),this.auto_compaction=n.auto_compaction,this.purged_infos_limit=n.purged_infos_limit||1e3,this.prefix=ne.prefix,"string"!=typeof t)throw new Error("Missing/invalid DB name");var i=function Bi(e,t){var n=e.match(/([a-z-]*):\/\/(.*)/);if(n)return{name:/https?/.test(n[1])?n[1]+"://"+n[2]:n[2],adapter:n[1]};var r=ne.adapters,i=ne.preferredAdapters,s=ne.prefix,a=t.adapter;if(!a)for(var u=0;u<i.length&&"idb"===(a=i[u])&&"websql"in r&&qt()&&localStorage["_pouch__websqldb_"+s+e];++u)Ke("log",'PouchDB is downgrading "'+e+'" to WebSQL to avoid data loss, because it was already opened with WebSQL.');var l=r[a];return{name:l&&"use_prefix"in l&&!l.use_prefix?e:s+e,adapter:a}}((n.prefix||"")+t,n);if(n.name=i.name,n.adapter=n.adapter||i.adapter,this.name=t,this._adapter=n.adapter,ne.emit("debug",["adapter","Picked adapter: ",n.adapter]),!ne.adapters[n.adapter]||!ne.adapters[n.adapter].valid())throw new Error("Invalid Adapter: "+n.adapter);if(n.view_adapter&&(!ne.adapters[n.view_adapter]||!ne.adapters[n.view_adapter].valid()))throw new Error("Invalid View Adapter: "+n.view_adapter);this.taskqueue=new Li,this.adapter=n.adapter,ne.adapters[n.adapter].call(this,n,s=>{if(s)return this.taskqueue.fail(s);(function ji(e){function t(r){e.removeListener("closed",n),r||e.constructor.emit("destroyed",e.name)}function n(){e.removeListener("destroyed",t),e.constructor.emit("unref",e)}e.once("destroyed",t),e.once("closed",n),e.constructor.emit("ref",e)})(this),this.emit("created",this),ne.emit("created",this.name),this.taskqueue.ready(this)})}}const ne=nr(rr,function(e,t){rr.prototype._setup.call(this,e,t)});var ir=fetch,wt=Headers;ne.adapters={},ne.preferredAdapters=[],ne.prefix="_pouch_";var sr=new(v());function un(e,t){for(var n=e,r=0,i=t.length;r<i&&(n=n[t[r]]);r++);return n}function cn(e){for(var t=[],n="",r=0,i=e.length;r<i;r++){var s=e[r];r>0&&"\\"===e[r-1]&&("$"===s||"."===s)?n=n.substring(0,n.length-1)+s:"."===s?(t.push(n),n=""):n+=s}return t.push(n),t}(function $i(e){Object.keys(v().prototype).forEach(function(n){"function"==typeof v().prototype[n]&&(e[n]=sr[n].bind(sr))});var t=e._destructionListeners=new Map;e.on("ref",function(r){t.has(r.name)||t.set(r.name,[]),t.get(r.name).push(r)}),e.on("unref",function(r){if(t.has(r.name)){var i=t.get(r.name),s=i.indexOf(r);s<0||(i.splice(s,1),i.length>1?t.set(r.name,i):t.delete(r.name))}}),e.on("destroyed",function(r){if(t.has(r)){var i=t.get(r);t.delete(r),i.forEach(function(s){s.emit("destroyed",!0)})}})})(ne),ne.adapter=function(e,t,n){t.valid()&&(ne.adapters[e]=t,n&&ne.preferredAdapters.push(e))},ne.plugin=function(e){if("function"==typeof e)e(ne);else{if("object"!=typeof e||0===Object.keys(e).length)throw new Error('Invalid plugin: got "'+e+'", expected an object or a function');Object.keys(e).forEach(function(t){ne.prototype[t]=e[t]})}return this.__defaults&&(ne.__defaults=Object.assign({},this.__defaults)),ne},ne.defaults=function(e){let t=nr(ne,function(n,r){r=r||{},n&&"object"==typeof n&&(n=(r=n).name,delete r.name),r=Object.assign({},t.__defaults,r),ne.call(this,n,r)});return t.preferredAdapters=ne.preferredAdapters.slice(),Object.keys(ne).forEach(function(n){n in t||(t[n]=ne[n])}),t.__defaults=Object.assign({},this.__defaults,e),t},ne.fetch=function(e,t){return ir(e,t)},ne.prototype.activeTasks=ne.activeTasks=new class Ni{constructor(){this.tasks={}}list(){return Object.values(this.tasks)}add(t){const n=ce();return this.tasks[n]={id:n,name:t.name,total_items:t.total_items,created_at:(new Date).toJSON()},n}get(t){return this.tasks[t]}remove(t,n){return delete this.tasks[t],this.tasks}update(t,n){const r=this.tasks[t];if(typeof r<"u"){const i={id:r.id,name:r.name,created_at:r.created_at,total_items:n.total_items||r.total_items,completed_items:n.completed_items||r.completed_items,updated_at:(new Date).toJSON()};this.tasks[t]=i}return this.tasks}};var Ki=["$or","$nor","$not"];function ar(e){return Ki.indexOf(e)>-1}function or(e){return Object.keys(e)[0]}function xt(e){var t={},n={$or:!0,$nor:!0};return e.forEach(function(r){Object.keys(r).forEach(function(i){var s=r[i];if("object"!=typeof s&&(s={$eq:s}),ar(i))if(s instanceof Array){if(n[i])return n[i]=!1,void(t[i]=s);var a=[];t[i].forEach(function(l){Object.keys(s).forEach(function(w){var b=s[w],E=Math.max(Object.keys(l).length,Object.keys(b).length),T=xt([l,b]);Object.keys(T).length<=E||a.push(T)})}),t[i]=a}else t[i]=xt([s]);else{var u=t[i]=t[i]||{};Object.keys(s).forEach(function(l){var w=s[l];return"$gt"===l||"$gte"===l?function Gi(e,t,n){typeof n.$eq<"u"||(typeof n.$gte<"u"?"$gte"===e?t>n.$gte&&(n.$gte=t):t>=n.$gte&&(delete n.$gte,n.$gt=t):typeof n.$gt<"u"?"$gte"===e?t>n.$gt&&(delete n.$gt,n.$gte=t):t>n.$gt&&(n.$gt=t):n[e]=t)}(l,w,u):"$lt"===l||"$lte"===l?function Ji(e,t,n){typeof n.$eq<"u"||(typeof n.$lte<"u"?"$lte"===e?t<n.$lte&&(n.$lte=t):t<=n.$lte&&(delete n.$lte,n.$lt=t):typeof n.$lt<"u"?"$lte"===e?t<n.$lt&&(delete n.$lt,n.$lte=t):t<n.$lt&&(n.$lt=t):n[e]=t)}(l,w,u):"$ne"===l?function zi(e,t){"$ne"in t?t.$ne.push(e):t.$ne=[e]}(w,u):"$eq"===l?function Qi(e,t){delete t.$gt,delete t.$gte,delete t.$lt,delete t.$lte,delete t.$ne,t.$eq=e}(w,u):"$regex"===l?function Wi(e,t){"$regex"in t?t.$regex.push(e):t.$regex=[e]}(w,u):void(u[l]=w)})}})}),t}function ur(e){for(var t in e){if(Array.isArray(e))for(var n in e)e[n].$and&&(e[n]=xt(e[n].$and));var r=e[t];"object"==typeof r&&ur(r)}return e}function cr(e,t){for(var n in e){"$and"===n&&(t=!0);var r=e[n];"object"==typeof r&&(t=cr(r,t))}return t}function Hi(e){var t=z(e);cr(t,!1)&&"$and"in(t=ur(t))&&(t=xt(t.$and)),["$or","$nor"].forEach(function(a){a in t&&t[a].forEach(function(u){for(var l=Object.keys(u),w=0;w<l.length;w++){var b=l[w],E=u[b];("object"!=typeof E||null===E)&&(u[b]={$eq:E})}})}),"$not"in t&&(t.$not=xt([t.$not]));for(var n=Object.keys(t),r=0;r<n.length;r++){var i=n[r],s=t[i];("object"!=typeof s||null===s)&&(s={$eq:s}),t[i]=s}return fn(t),t}function fn(e){Object.keys(e).forEach(function(t){var n=e[t];Array.isArray(n)?n.forEach(function(r){r&&"object"==typeof r&&fn(r)}):"$ne"===t?e.$ne=[n]:"$regex"===t?e.$regex=[n]:n&&"object"==typeof n&&fn(n)})}var fr=-324,ln=3,dn="";function De(e,t){if(e===t)return 0;e=ft(e),t=ft(t);var n=hn(e),r=hn(t);if(n-r!=0)return n-r;switch(typeof e){case"number":return e-t;case"boolean":return e<t?-1:1;case"string":return function rs(e,t){return e===t?0:e>t?1:-1}(e,t)}return Array.isArray(e)?function ns(e,t){for(var n=Math.min(e.length,t.length),r=0;r<n;r++){var i=De(e[r],t[r]);if(0!==i)return i}return e.length===t.length?0:e.length>t.length?1:-1}(e,t):function is(e,t){for(var n=Object.keys(e),r=Object.keys(t),i=Math.min(n.length,r.length),s=0;s<i;s++){var a=De(n[s],r[s]);if(0!==a||0!==(a=De(e[n[s]],t[r[s]])))return a}return n.length===r.length?0:n.length>r.length?1:-1}(e,t)}function ft(e){switch(typeof e){case"undefined":return null;case"number":return e===1/0||e===-1/0||isNaN(e)?null:e;case"object":var t=e;if(Array.isArray(e)){var n=e.length;e=new Array(n);for(var r=0;r<n;r++)e[r]=ft(t[r])}else{if(e instanceof Date)return e.toJSON();if(null!==e)for(var i in e={},t)if(Object.prototype.hasOwnProperty.call(t,i)){var s=t[i];typeof s<"u"&&(e[i]=ft(s))}}}return e}function Qe(e){return hn(e=ft(e))+dn+function Zi(e){if(null!==e)switch(typeof e){case"boolean":return e?1:0;case"number":return function ss(e){if(0===e)return"1";var t=e.toExponential().split(/e\+?/),n=parseInt(t[1],10),r=e<0,i=r?"0":"2",a=function Xi(e,t,n){var r=function Yi(e,t,n){for(var r="",i=n-e.length;r.length<i;)r+=t;return r}(e,t,n);return r+e}(((r?-n:n)-fr).toString(),"0",ln);i+=dn+a;var u=Math.abs(parseFloat(t[0]));r&&(u=10-u);var l=u.toFixed(20);return l=l.replace(/\.?0+$/,""),i+(dn+l)}(e);case"string":return e.replace(/\u0002/g,"\x02\x02").replace(/\u0001/g,"\x01\x02").replace(/\u0000/g,"\x01\x01");case"object":var t=Array.isArray(e),n=t?e:Object.keys(e),r=-1,i=n.length,s="";if(t)for(;++r<i;)s+=Qe(n[r]);else for(;++r<i;){var a=n[r];s+=Qe(a)+Qe(e[a])}return s}return""}(e)+"\0"}function Vi(e,t){var r,n=t;if("1"===e[t])r=0,t++;else{var s="0"===e[t];t++;var a="",u=e.substring(t,t+ln),l=parseInt(u,10)+fr;for(s&&(l=-l),t+=ln;;){var w=e[t];if("\0"===w)break;a+=w,t++}r=1===(a=a.split(".")).length?parseInt(a,10):parseFloat(a[0]+"."+a[1]),s&&(r-=10),0!==l&&(r=parseFloat(r+"e"+l))}return{num:r,length:t-n}}function es(e,t){var n=e.pop();if(t.length){var r=t[t.length-1];n===r.element&&(t.pop(),r=t[t.length-1]);var i=r.element,s=r.index;Array.isArray(i)?i.push(n):s===e.length-2?i[e.pop()]=n:e.push(n)}}function hn(e){var n=["boolean","number","string","object"].indexOf(typeof e);return~n?null===e?1:Array.isArray(e)?5:n<3?n+2:n+3:Array.isArray(e)?5:void 0}function bt(e,t,n){return n.every(function(r){var i=t[r],s=cn(r),a=un(e,s);return ar(r)?function us(e,t,n){return"$or"===e?t.some(function(r){return bt(n,r,Object.keys(r))}):"$not"===e?!bt(n,t,Object.keys(t)):!t.find(function(r){return bt(n,r,Object.keys(r))})}(r,i,e):Pt(i,e,s,a)})}function Pt(e,t,n,r){return!e||("object"==typeof e?Object.keys(e).every(function(i){var s=e[i];if(0===i.indexOf("$"))return lr(i,t,s,n,r);var a=cn(i);if(void 0===r&&"object"!=typeof s&&a.length>0)return!1;var u=un(r,a);return"object"==typeof s?Pt(s,t,n,u):lr("$eq",t,s,a,u)}):e===r)}function lr(e,t,n,r,i){if(!hr[e])throw new Error('unknown operator "'+e+'" - should be one of $eq, $lte, $lt, $gt, $gte, $exists, $ne, $in, $nin, $size, $mod, $regex, $elemMatch, $type, $allMatch or $all');return hr[e](t,n,r,i)}function Ct(e){return typeof e<"u"&&null!==e}function lt(e){return typeof e<"u"}function dr(e,t){return t.some(function(n){return e instanceof Array?e.some(function(r){return 0===De(n,r)}):0===De(n,e)})}var hr={$elemMatch:function(e,t,n,r){return!(!Array.isArray(r)||0===r.length)&&r.some("object"==typeof r[0]&&null!==r[0]?function(i){return bt(i,t,Object.keys(t))}:function(i){return Pt(t,e,n,i)})},$allMatch:function(e,t,n,r){return!(!Array.isArray(r)||0===r.length)&&r.every("object"==typeof r[0]&&null!==r[0]?function(i){return bt(i,t,Object.keys(t))}:function(i){return Pt(t,e,n,i)})},$eq:function(e,t,n,r){return lt(r)&&0===De(r,t)},$gte:function(e,t,n,r){return lt(r)&&De(r,t)>=0},$gt:function(e,t,n,r){return lt(r)&&De(r,t)>0},$lte:function(e,t,n,r){return lt(r)&&De(r,t)<=0},$lt:function(e,t,n,r){return lt(r)&&De(r,t)<0},$exists:function(e,t,n,r){return t?lt(r):!lt(r)},$mod:function(e,t,n,r){return Ct(r)&&function cs(e,t){return"number"==typeof e&&parseInt(e,10)===e&&e%t[0]===t[1]}(r,t)},$ne:function(e,t,n,r){return t.every(function(i){return 0!==De(r,i)})},$in:function(e,t,n,r){return Ct(r)&&dr(r,t)},$nin:function(e,t,n,r){return Ct(r)&&!dr(r,t)},$size:function(e,t,n,r){return Ct(r)&&Array.isArray(r)&&function ls(e,t){return e.length===t}(r,t)},$all:function(e,t,n,r){return Array.isArray(r)&&function fs(e,t){return t.every(function(n){return e.some(function(r){return 0===De(n,r)})})}(r,t)},$regex:function(e,t,n,r){return Ct(r)&&"string"==typeof r&&t.every(function(i){return function ds(e,t){return new RegExp(t).test(e)}(r,i)})},$type:function(e,t,n,r){return function hs(e,t){switch(t){case"null":return null===e;case"boolean":return"boolean"==typeof e;case"number":return"number"==typeof e;case"string":return"string"==typeof e;case"array":return e instanceof Array;case"object":return"[object Object]"==={}.toString.call(e)}}(r,t)}};function ps(e,t){if(e.selector&&e.filter&&"_selector"!==e.filter)return t(new Error('selector invalid for filter "'+("string"==typeof e.filter?e.filter:"function")+'"'));t()}function ys(e){e.view&&!e.filter&&(e.filter="_view"),e.selector&&!e.filter&&(e.filter="_selector"),e.filter&&"string"==typeof e.filter&&("_view"===e.filter?e.view=Mn(e.view):e.filter=Mn(e.filter))}function ms(e,t){return t.filter&&"string"==typeof t.filter&&!t.doc_ids&&!Ve(e.db)}function ws(e,t){var n=t.complete;if("_view"===t.filter){if(!t.view||"string"!=typeof t.view){var r=ee(Dt,"`view` filter parameter not found or invalid.");return n(r)}var i=Wt(t.view);e.db.get("_design/"+i[0],function(a,u){if(e.isCancelled)return n(null,{status:"cancelled"});if(a)return n(mt(a));var l=u&&u.views&&u.views[i[1]]&&u.views[i[1]].map;if(!l)return n(ee(Ue,u.views?"missing json key: "+i[1]:"missing json key: views"));t.filter=function gs(e){return Ht(["return function(doc) {",'  "use strict";',"  var emitted = false;","  var emit = function (a, b) {","    emitted = true;","  };","  var view = "+e+";","  view(doc);","  if (emitted) {","    return true;","  }","};"].join("\n"),{})}(l),e.doChanges(t)})}else if(t.selector)t.filter=function(a){return function vs(e,t){if("object"!=typeof t)throw new Error("Selector error: expected a JSON object");var r=function os(e,t,n){if(e=e.filter(function(a){return bt(a.doc,t.selector,n)}),t.sort){var r=function as(e){function t(n){return e.map(function(r){var s=cn(or(r));return un(n,s)})}return function(n,r){var a=De(t(n.doc),t(r.doc));return 0!==a?a:function Mi(e,t){return e<t?-1:e>t?1:0}(n.doc._id,r.doc._id)}}(t.sort);e=e.sort(r),"string"!=typeof t.sort[0]&&"desc"===function Ui(e){return e[or(e)]}(t.sort[0])&&(e=e.reverse())}if("limit"in t||"skip"in t){var i=t.skip||0;e=e.slice(i,("limit"in t?t.limit:e.length)+i)}return e}([{doc:e}],{selector:t=Hi(t)},Object.keys(t));return r&&1===r.length}(a,t.selector)},e.doChanges(t);else{var s=Wt(t.filter);e.db.get("_design/"+s[0],function(a,u){if(e.isCancelled)return n(null,{status:"cancelled"});if(a)return n(mt(a));var l=u&&u.filters&&u.filters[s[1]];if(!l)return n(ee(Ue,u&&u.filters?"missing json key: "+s[1]:"missing json key: filters"));t.filter=function _s(e){return Ht('"use strict";\nreturn '+e+";",{})}(l),e.doChanges(t)})}}function vr(e){return e.reduce(function(t,n){return t[n]=!0,t},{})}ne.plugin(function bs(e){e._changesFilterPlugin={validate:ps,normalize:ys,shouldFilter:ms,filter:ws}}),ne.version="9.0.0";var Ss=vr(["_id","_rev","_access","_attachments","_deleted","_revisions","_revs_info","_conflicts","_deleted_conflicts","_local_seq","_rev_tree","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats","_removed"]),xs=vr(["_access","_attachments","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats"]);function _r(e){if(!/^\d+-/.test(e))return ee(kt);var t=e.indexOf("-"),n=e.substring(0,t),r=e.substring(t+1);return{prefix:parseInt(n,10),id:r}}function gr(e,t,n){n||(n={deterministic_revs:!0});var r,i,s,a={status:"available"};if(e._deleted&&(a.deleted=!0),t)if(e._id||(e._id=Rt()),i=Wn(e,n.deterministic_revs),e._rev){if((s=_r(e._rev)).error)return s;e._rev_tree=[{pos:s.prefix,ids:[s.id,{status:"missing"},[[i,a,[]]]]}],r=s.prefix+1}else e._rev_tree=[{pos:1,ids:[i,a,[]]}],r=1;else if(e._revisions&&(e._rev_tree=function Cs(e,t){for(var n=e.start-e.ids.length+1,r=e.ids,i=[r[0],t,[]],s=1,a=r.length;s<a;s++)i=[r[s],{status:"missing"},[i]];return[{pos:n,ids:i}]}(e._revisions,a),r=e._revisions.start,i=e._revisions.ids[0]),!e._rev_tree){if((s=_r(e._rev)).error)return s;e._rev_tree=[{pos:r=s.prefix,ids:[i=s.id,a,[]]}]}Fn(e._id),e._rev=r+"-"+i;var u={metadata:{},data:{}};for(var l in e)if(Object.prototype.hasOwnProperty.call(e,l)){var w="_"===l[0];if(w&&!Ss[l]){var b=ee($n,l);throw b.message=$n.message+": "+l,b}w&&!xs[l]?u.metadata[l.slice(1)]=e[l]:u.data[l]=e[l]}return u}function Ds(e,t,n){if(e.stub)return n();"string"==typeof e.data?function Es(e,t,n){var r=function Os(e){try{return Yt(e)}catch{return{error:ee(Nn,"Attachment is not a valid base64 string")}}}(e.data);if(r.error)return n(r.error);e.length=r.length,e.data="blob"===t?Zt(r,e.content_type):"base64"===t?St(r):r,tn(r,function(i){e.digest="md5-"+i,n()})}(e,t,n):function qs(e,t,n){tn(e.data,function(r){e.digest="md5-"+r,e.length=e.data.size||e.data.length||0,"binary"===t?zn(e.data,function(i){e.data=i,n()}):"base64"===t?en(e.data,function(i){e.data=i,n()}):n()})}(e,t,n)}function Ps(e,t,n,r,i,s,a,u,l){e=e||1e3;var b=u.new_edits,E=new Map,T=0,g=t.length;function m(){++T===g&&l&&l()}t.forEach(function(y,d){if(y._id&&ct(y._id))n[y._deleted?"_removeLocal":"_putLocal"](y,{ctx:i},function(S,q){s[d]=S||q,m()});else{var A=y.metadata.id;E.has(A)?(g--,E.get(A).push([y,d])):E.set(A,[[y,d]])}}),E.forEach(function(y,d){var _=0;function A(){++_<y.length?S():m()}function S(){var q=y[_],x=q[0],D=q[1];if(r.has(d))!function Ts(e,t,n,r,i,s,a,u){if(function bi(e,t){for(var a,n=e.slice(),r=t.split("-"),i=parseInt(r[0],10),s=r[1];a=n.pop();){if(a.pos===i&&a.ids[0]===s)return!0;for(var u=a.ids[2],l=0,w=u.length;l<w;l++)n.push({pos:a.pos+1,ids:u[l]})}return!1}(t.rev_tree,n.metadata.rev)&&!u)return r[i]=n,s();var l=t.winningRev||ot(t),w="deleted"in t?t.deleted:nt(t,l),b="deleted"in n.metadata?n.metadata.deleted:nt(n.metadata),E=/^1-/.test(n.metadata.rev);if(w&&!b&&u&&E){var T=n.data;T._rev=l,T._id=n.metadata.id,n=gr(T,u)}var g=Vn(t.rev_tree,n.metadata.rev_tree[0],e);if(u&&(w&&b&&"new_leaf"!==g.conflicts||!w&&"new_leaf"!==g.conflicts||w&&!b&&"new_branch"===g.conflicts)){var y=ee(yt);return r[i]=y,s()}var d=n.metadata.rev;n.metadata.rev_tree=g.tree,n.stemmedRevs=g.stemmedRevs||[],t.rev_map&&(n.metadata.rev_map=t.rev_map);var _=ot(n.metadata),A=nt(n.metadata,_),S=w===A?0:w<A?-1:1;a(n,_,A,d===_?A:nt(n.metadata,d),!0,S,i,s)}(e,r.get(d),x,s,D,A,a,b);else{var L=Vn([],x.metadata.rev_tree[0],e);x.metadata.rev_tree=L.tree,x.stemmedRevs=L.stemmedRevs||[],function w(y,d,_){var A=ot(y.metadata),S=nt(y.metadata,A);if("was_delete"in u&&S)return s[d]=ee(Ue,"deleted"),_();var q=b&&function Rs(e){return"missing"===e.metadata.rev_tree[0].ids[1].status}(y);if(q){var x=ee(yt);return s[d]=x,_()}a(y,A,S,S,!1,S?0:1,d,_)}(x,D,A)}}S()})}var ke="document-store",Ie="by-sequence",Ge="attach-store",dt="attach-seq-store",Ne="meta-store",et="local-store",vn="detect-blob-support";function Is(e){try{return JSON.stringify(e)}catch{return k.stringify(e)}}function tt(e){return function(t){var n="unknown_error";t.target&&t.target.error&&(n=t.target.error.name||t.target.error.message),e(ee(zt,n))}}function _n(e,t,n){return{data:Is(e),winningRev:t,deletedOrLocal:n?"1":"0",seq:e.seq,id:e.id}}function ht(e){if(!e)return null;var t=function Bs(e){try{return JSON.parse(e)}catch{return k.parse(e)}}(e.data);return t.winningRev=e.winningRev,t.deleted="1"===e.deletedOrLocal,t.seq=e.seq,t}function Lt(e){if(!e)return e;var t=e._doc_id_rev.lastIndexOf(":");return e._id=e._doc_id_rev.substring(0,t-1),e._rev=e._doc_id_rev.substring(t+1),delete e._doc_id_rev,e}function pr(e,t,n,r){n?r(e?"string"!=typeof e?e:Vt(e,t):Xt([""],{type:t})):e?"string"!=typeof e?Jn(e,function(i){r(St(i))}):r(e):r("")}function yr(e,t,n,r){var i=Object.keys(e._attachments||{});if(!i.length)return r&&r();var s=0;function a(){++s===i.length&&r&&r()}i.forEach(function(l){t.attachments&&t.include_docs?function u(l,w){var b=l._attachments[w],E=b.digest;n.objectStore(Ge).get(E).onsuccess=function(g){b.body=g.target.result.body,a()}}(e,l):(e._attachments[l].stub=!0,a())})}function gn(e,t){return Promise.all(e.map(function(n){if(n.doc&&n.doc._attachments){var r=Object.keys(n.doc._attachments);return Promise.all(r.map(function(i){var s=n.doc._attachments[i];if("body"in s){var a=s.body,u=s.content_type;return new Promise(function(l){pr(a,u,t,function(w){n.doc._attachments[i]=Object.assign(at(s,["digest","content_type"]),{data:w}),l()})})}}))}}))}function mr(e,t,n){var r=[],i=n.objectStore(Ie),s=n.objectStore(Ge),a=n.objectStore(dt),u=e.length;function l(){--u||function w(){r.length&&r.forEach(function(b){a.index("digestSeq").count(IDBKeyRange.bound(b+"::",b+"::\uffff",!1,!1)).onsuccess=function(T){T.target.result||s.delete(b)}})}()}e.forEach(function(b){i.index("_doc_id_rev").getKey(t+"::"+b).onsuccess=function(g){var m=g.target.result;if("number"!=typeof m)return l();i.delete(m),a.index("seq").openCursor(IDBKeyRange.only(m)).onsuccess=function(d){var _=d.target.result;if(_){var A=_.value.digestSeq.split("::")[0];r.push(A),a.delete(_.primaryKey),_.continue()}else l()}}})}function We(e,t,n){try{return{txn:e.transaction(t,n)}}catch(r){return{error:r}}}var Ot=new zr;function js(e,t,n,r,i,s){for(var u,l,w,b,E,T,g,m,a=t.docs,y=0,d=a.length;y<d;y++){var _=a[y];_._id&&ct(_._id)||(_=a[y]=gr(_,n.new_edits,e)).error&&!g&&(g=_)}if(g)return s(g);var A=!1,S=0,q=new Array(a.length),x=new Map,D=!1;function P(){A=!0,I()}function I(){!m||!A||(m.docCount+=S,T.put(m))}function F(){D||(Ot.notify(r._meta.name),s(null,q))}function se(Q,ae,he,xe,we,h,p,C){Q.metadata.winningRev=ae,Q.metadata.deleted=he;var R=Q.data;if(R._id=Q.metadata.id,R._rev=Q.metadata.rev,xe&&(R._deleted=!0),R._attachments&&Object.keys(R._attachments).length)return function ue(Q,ae,he,xe,we,h){var C=0,R=Object.keys(Q.data._attachments);function j(){C===R.length&&Z(Q,ae,he,xe,we,h)}function W(){C++,j()}R.forEach(function(oe){var X=Q.data._attachments[oe];if(X.stub)C++,j();else{var H=X.data;delete X.data,X.revpos=parseInt(ae,10),function Ye(Q,ae,he){b.count(Q).onsuccess=function(we){if(we.target.result)return he();b.put({digest:Q,body:ae}).onsuccess=he}}(X.digest,H,W)}})}(Q,ae,he,we,p,C);S+=h,I(),Z(Q,ae,he,we,p,C)}function Z(Q,ae,he,xe,we,h){var p=Q.data,C=Q.metadata;function R(X){var H=Q.stemmedRevs||[];xe&&r.auto_compaction&&(H=H.concat(function vi(e){var t=[];return ut(e.rev_tree,function(n,r,i,s,a){"available"===a.status&&!n&&(t.push(r+"-"+i),a.status="missing")}),t}(Q.metadata))),H&&H.length&&mr(H,Q.metadata.id,u),C.seq=X.target.result;var K=_n(C,ae,he);l.put(K).onsuccess=W}function W(){q[we]={ok:!0,id:C.id,rev:C.rev},x.set(Q.metadata.id,Q.metadata),function Ee(Q,ae,he){var xe=0,we=Object.keys(Q.data._attachments||{});if(!we.length)return he();function h(){++xe===we.length&&he()}function p(R){var W=E.put({seq:ae,digestSeq:Q.data._attachments[R].digest+"::"+ae});W.onsuccess=h,W.onerror=function(oe){oe.preventDefault(),oe.stopPropagation(),h()}}for(var C=0;C<we.length;C++)p(we[C])}(Q,C.seq,h)}p._doc_id_rev=C.id+"::"+C.rev,delete p._id,delete p._rev;var oe=w.put(p);oe.onsuccess=R,oe.onerror=function j(X){X.preventDefault(),X.stopPropagation(),w.index("_doc_id_rev").getKey(p._doc_id_rev).onsuccess=function(re){w.put(p,re.target.result).onsuccess=R}}}!function ks(e,t,n){if(!e.length)return n();var i,r=0;function s(){r++,e.length===r&&(i?n(i):n())}e.forEach(function(a){var u=a.data&&a.data._attachments?Object.keys(a.data._attachments):[],l=0;if(!u.length)return s();function w(E){i=E,++l===u.length&&s()}for(var b in a.data._attachments)Object.prototype.hasOwnProperty.call(a.data._attachments,b)&&Ds(a.data._attachments[b],t,w)})}(a,r._meta.blobSupport?"blob":"base64",function(Q){if(Q)return s(Q);!function B(){var ae=We(i,[ke,Ie,Ge,et,dt,Ne],"readwrite");if(ae.error)return s(ae.error);(u=ae.txn).onabort=tt(s),u.ontimeout=tt(s),u.oncomplete=F,l=u.objectStore(ke),w=u.objectStore(Ie),b=u.objectStore(Ge),E=u.objectStore(dt),(T=u.objectStore(Ne)).get(Ne).onsuccess=function(he){m=he.target.result,I()},function Y(Q){var ae=[];if(a.forEach(function(h){h.data&&h.data._attachments&&Object.keys(h.data._attachments).forEach(function(p){var C=h.data._attachments[p];C.stub&&ae.push(C.digest)})}),!ae.length)return Q();var xe,he=0;ae.forEach(function(h){!function M(Q,ae){b.get(Q).onsuccess=function(xe){if(xe.target.result)ae();else{var we=ee(Vr,"unknown stub attachment with digest "+Q);we.status=412,ae(we)}}}(h,function(p){p&&!xe&&(xe=p),function we(){++he===ae.length&&Q(xe)}()})})}(function(he){if(he)return D=!0,s(he);!function V(){if(a.length)for(var Q=0,xe=0,we=a.length;xe<we;xe++){var h=a[xe];h._id&&ct(h._id)?ae():l.get(h.metadata.id).onsuccess=he}function ae(){++Q===a.length&&function $(){Ps(e.revs_limit,a,r,x,u,q,se,n,P)}()}function he(C){var R=ht(C.target.result);R&&x.set(R.id,R),ae()}}()})}()})}function wr(e,t,n,r,i){var a,u,l;function w(g){u=g.target.result,a&&i(a,u,l)}function b(g){a=g.target.result,u&&i(a,u,l)}function T(g){var m=g.target.result;if(!m)return i();i([m.key],[m.value],m)}-1===r&&(r=1e3),"function"==typeof e.getAll&&"function"==typeof e.getAllKeys&&r>1&&!n?(l={continue:function E(){if(!a.length)return i();var m,g=a[a.length-1];if(t&&t.upper)try{m=IDBKeyRange.bound(g,t.upper,!0,t.upperOpen)}catch(y){if("DataError"===y.name&&0===y.code)return i()}else m=IDBKeyRange.lowerBound(g,!0);a=null,u=null,e.getAll(t=m,r).onsuccess=w,e.getAllKeys(t,r).onsuccess=b}},e.getAll(t,r).onsuccess=w,e.getAllKeys(t,r).onsuccess=b):n?e.openCursor(t,"prev").onsuccess=T:e.openCursor(t).onsuccess=T}var pn=!1,yn=[];function br(){pn||!yn.length||(pn=!0,yn.shift()())}var mn,At=new Map,wn=new Map;function Ar(e,t){var n=this;!function Gs(e,t,n){yn.push(function(){e(function(s,a){(function Us(e,t,n,r){try{e(t,n)}catch(i){r.emit("error",i)}})(t,s,a,n),pn=!1,Ze(function(){br()})})}),br()}(function(r){!function zs(e,t,n){var r=t.name,i=null,s=null;function a(d){return function(_,A){_&&_ instanceof Error&&!_.reason&&s&&(_.reason=s),d(_,A)}}function l(d,_){var A=d.objectStore(ke);A.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),A.openCursor().onsuccess=function(S){var q=S.target.result;if(q){var x=q.value,D=nt(x);x.deletedOrLocal=D?"1":"0",A.put(x),q.continue()}else _()}}function b(d,_){var A=d.objectStore(et),S=d.objectStore(ke),q=d.objectStore(Ie);S.openCursor().onsuccess=function(D){var L=D.target.result;if(L){var B=L.value,P=B.id,$=ct(P),I=ot(B);if($){var V=P+"::"+I,F=P+"::",M=P+"::~",Y=q.index("_doc_id_rev"),se=IDBKeyRange.bound(F,M,!1,!1),Z=Y.openCursor(se);Z.onsuccess=function(ue){if(Z=ue.target.result){var Ee=Z.value;Ee._doc_id_rev===V&&A.put(Ee),q.delete(Z.primaryKey),Z.continue()}else S.delete(L.primaryKey),L.continue()}}else L.continue()}else _&&_()}}function T(d,_){var A=d.objectStore(Ie),S=d.objectStore(Ge),q=d.objectStore(dt);S.count().onsuccess=function(D){if(!D.target.result)return _();A.openCursor().onsuccess=function(B){var P=B.target.result;if(!P)return _();for(var $=P.value,I=P.primaryKey,V=Object.keys($._attachments||{}),F={},M=0;M<V.length;M++)F[$._attachments[V[M]].digest]=!0;var se=Object.keys(F);for(M=0;M<se.length;M++)q.put({seq:I,digestSeq:se[M]+"::"+I});P.continue()}}}function g(d){var A=d.objectStore(Ie),S=d.objectStore(ke);S.openCursor().onsuccess=function(x){var D=x.target.result;if(D){var L=function _(x){return x.data?ht(x):(x.deleted="1"===x.deletedOrLocal,x)}(D.value);if(L.winningRev=L.winningRev||ot(L),L.seq)return P();!function B(){var $=L.id+"::",I=L.id+"::\uffff",V=A.index("_doc_id_rev").openCursor(IDBKeyRange.bound($,I)),F=0;V.onsuccess=function(M){var Y=M.target.result;if(!Y)return L.seq=F,P();var se=Y.primaryKey;se>F&&(F=se),Y.continue()}}()}function P(){var $=_n(L,L.winningRev,L.deleted);S.put($).onsuccess=function(){D.continue()}}}}e._meta=null,e._remote=!1,e.type=function(){return"idb"},e._id=Me(function(d){d(null,e._meta.instanceId)}),e._bulkDocs=function(_,A,S){js(t,_,A,e,i,a(S))},e._get=function(_,A,S){var q,x,D,L=A.ctx;if(!L){var B=We(i,[ke,Ie,Ge],"readonly");if(B.error)return S(B.error);L=B.txn}function P(){S(D,{doc:q,metadata:x,ctx:L})}L.objectStore(ke).get(_).onsuccess=function($){if(!(x=ht($.target.result)))return D=ee(Ue,"missing"),P();var I;if(A.rev)I=A.latest?function Si(e,t){for(var r,n=t.rev_tree.slice();r=n.pop();){var i=r.pos,s=r.ids,a=s[0],u=s[1],l=s[2],w=0===l.length,b=r.history?r.history.slice():[];if(b.push({id:a,pos:i,opts:u}),w)for(var E=0,T=b.length;E<T;E++){var g=b[E];if(g.pos+"-"+g.id===e)return i+"-"+a}for(var y=0,d=l.length;y<d;y++)n.push({pos:i+1,ids:l[y],history:b})}throw new Error("Unable to resolve latest revision for id "+t.id+", rev "+e)}(A.rev,x):A.rev;else if(I=x.winningRev,nt(x))return D=ee(Ue,"deleted"),P();var F=L.objectStore(Ie),M=x.id+"::"+I;F.index("_doc_id_rev").get(M).onsuccess=function(Y){if((q=Y.target.result)&&(q=Lt(q)),!q)return D=ee(Ue,"missing"),P();P()}}},e._getAttachment=function(d,_,A,S,q){var x;if(S.ctx)x=S.ctx;else{var D=We(i,[ke,Ie,Ge],"readonly");if(D.error)return q(D.error);x=D.txn}var L=A.digest,B=A.content_type;x.objectStore(Ge).get(L).onsuccess=function(P){pr(P.target.result.body,B,S.binary,function(I){q(null,I)})}},e._info=function(_){var A,S,q=We(i,[Ne,Ie],"readonly");if(q.error)return _(q.error);var x=q.txn;x.objectStore(Ne).get(Ne).onsuccess=function(D){S=D.target.result.docCount},x.objectStore(Ie).openKeyCursor(null,"prev").onsuccess=function(D){var L=D.target.result;A=L?L.key:0},x.oncomplete=function(){_(null,{doc_count:S,update_seq:A,idb_attachment_format:e._meta.blobSupport?"binary":"base64"})}},e._allDocs=function(_,A){!function Ms(e,t,n){var b,E,a="keys"in e&&e.keys,u=e.skip||0,l="number"==typeof e.limit?e.limit:-1;if(!a&&(b=function Fs(e,t,n,r,i){try{if(e&&t)return i?IDBKeyRange.bound(t,e,!n,!1):IDBKeyRange.bound(e,t,!1,!n);if(e)return i?IDBKeyRange.upperBound(e):IDBKeyRange.lowerBound(e);if(t)return i?IDBKeyRange.lowerBound(t,!n):IDBKeyRange.upperBound(t,!n);if(r)return IDBKeyRange.only(r)}catch(s){return{error:s}}return null}("startkey"in e&&e.startkey,"endkey"in e&&e.endkey,!1!==e.inclusive_end,"key"in e&&e.key,e.descending),(E=b&&b.error)&&("DataError"!==E.name||0!==E.code)))return n(ee(zt,E.name));var T=[ke,Ie,Ne];e.attachments&&T.push(Ge);var g=We(t,T,"readonly");if(g.error)return n(g.error);var m=g.txn;m.oncomplete=function V(){e.attachments?gn(S,e.binary).then(I):I()},m.onabort=tt(n);var q,x,y=m.objectStore(ke),d=m.objectStore(Ie),_=m.objectStore(Ne),A=d.index("_doc_id_rev"),S=[];function L(F,M){var Y={id:M.id,key:M.id,value:{rev:F}};M.deleted?a&&(S.push(Y),Y.value.deleted=!0,Y.doc=null):u--<=0&&(S.push(Y),e.include_docs&&function D(F,M,Y){A.get(F.id+"::"+Y).onsuccess=function(ue){if(M.doc=Lt(ue.target.result)||{},e.conflicts){var Ee=rn(F);Ee.length&&(M.doc._conflicts=Ee)}yr(M.doc,e,m)}}(M,Y,F))}function B(F){for(var M=0,Y=F.length;M<Y&&S.length!==l;M++){var se=F[M];if(se.error&&a)S.push(se);else{var Z=ht(se);L(Z.winningRev,Z)}}}function P(F,M,Y){Y&&(B(M),S.length<l&&Y.continue())}function I(){var F={total_rows:q,offset:e.skip,rows:S};e.update_seq&&void 0!==x&&(F.update_seq=x),n(null,F)}if(_.get(Ne).onsuccess=function(F){q=F.target.result.docCount},e.update_seq&&(d.openKeyCursor(null,"prev").onsuccess=F=>{var M=F.target.result;M&&M.key&&(x=M.key)}),!E&&0!==l){if(a)return function $s(e,t,n){var r=new Array(e.length),i=0;e.forEach(function(s,a){t.get(s).onsuccess=function(u){r[a]=u.target.result?u.target.result:{key:s,error:"not_found"},++i===e.length&&n(e,r,{})}})}(a,y,P);if(-1===l)return function Ns(e,t,n){if("function"!=typeof e.getAll){var r=[];e.openCursor(t).onsuccess=function i(s){var a=s.target.result;a?(r.push(a.value),a.continue()):n({target:{result:r}})}}else e.getAll(t).onsuccess=n}(y,b,function $(F){var M=F.target.result;e.descending&&(M=M.reverse()),B(M)});wr(y,b,e.descending,l+u,P)}}(_,i,a(A))},e._changes=function(_){return function Js(e,t,n,r){if((e=z(e)).continuous){var i=n+":"+Rt();return Ot.addListener(n,i,t,e),Ot.notify(n),{cancel:function(){Ot.removeListener(n,i)}}}var s=e.doc_ids&&new Set(e.doc_ids);e.since=e.since||0;var a=e.since,u="limit"in e?e.limit:-1;0===u&&(u=1);var T,g,m,y,l=[],w=0,b=Qt(e),E=new Map;function _(B,P,$,I){return $.seq!==P?I():$.winningRev===B._rev?I($,B):void(y.get(B._id+"::"+$.winningRev).onsuccess=function(M){I($,Lt(M.target.result))})}function S(){e.complete(null,{results:l,last_seq:a})}var x=[ke,Ie];e.attachments&&x.push(Ge);var D=We(r,x,"readonly");if(D.error)return e.complete(D.error);(T=D.txn).onabort=tt(e.complete),T.oncomplete=function q(){!e.continuous&&e.attachments?gn(l).then(S):S()},g=T.objectStore(Ie),m=T.objectStore(ke),y=g.index("_doc_id_rev"),wr(g,e.since&&!e.descending?IDBKeyRange.lowerBound(e.since,!0):null,e.descending,u,function d(B,P,$){if($&&B.length){var I=new Array(B.length),V=new Array(B.length),Y=0;P.forEach(function(se,Z){!function A(B,P,$){if(s&&!s.has(B._id))return $();var I=E.get(B._id);if(I)return _(B,P,I,$);m.get(B._id).onsuccess=function(V){I=ht(V.target.result),E.set(B._id,I),_(B,P,I,$)}}(Lt(se),B[Z],function(Ye,Q){V[Z]=Ye,I[Z]=Q,++Y===B.length&&function M(){for(var se=[],Z=0,ue=I.length;Z<ue&&w!==u;Z++){var Ee=I[Z];Ee&&se.push(F(V[Z],Ee))}Promise.all(se).then(function(Q){for(var ae=0,he=Q.length;ae<he;ae++)Q[ae]&&e.onChange(Q[ae])}).catch(e.complete),w!==u&&$.continue()}()})})}function F(se,Z){var ue=e.processChange(Z,se,e);a=ue.seq=se.seq;var Ee=b(ue);return"object"==typeof Ee?Promise.reject(Ee):Ee?(w++,e.return_docs&&l.push(ue),e.attachments&&e.include_docs?new Promise(function(Ye){yr(Z,e,T,function(){gn([ue],e.binary).then(function(){Ye(ue)})})}):Promise.resolve(ue)):Promise.resolve()}})}(_,e,r,i)},e._close=function(d){i.close(),At.delete(r),d()},e._getRevisionTree=function(d,_){var A=We(i,[ke],"readonly");if(A.error)return _(A.error);A.txn.objectStore(ke).get(d).onsuccess=function(x){var D=ht(x.target.result);D?_(null,D.rev_tree):_(ee(Ue))}},e._doCompaction=function(d,_,A){var q=We(i,[ke,Ie,Ge,dt],"readwrite");if(q.error)return A(q.error);var x=q.txn;x.objectStore(ke).get(d).onsuccess=function(L){var B=ht(L.target.result);ut(B.rev_tree,function(I,V,F,M,Y){-1!==_.indexOf(V+"-"+F)&&(Y.status="missing")}),mr(_,d,x);var P=B.winningRev,$=B.deleted;x.objectStore(ke).put(_n(B,P,$))},x.onabort=tt(A),x.oncomplete=function(){A()}},e._getLocal=function(d,_){var A=We(i,[et],"readonly");if(A.error)return _(A.error);var q=A.txn.objectStore(et).get(d);q.onerror=tt(_),q.onsuccess=function(x){var D=x.target.result;D?(delete D._doc_id_rev,_(null,D)):_(ee(Ue))}},e._putLocal=function(d,_,A){"function"==typeof _&&(A=_,_={}),delete d._revisions;var S=d._rev,q=d._id;d._rev=S?"0-"+(parseInt(S.split("-")[1],10)+1):"0-1";var D,x=_.ctx;if(!x){var L=We(i,[et],"readwrite");if(L.error)return A(L.error);(x=L.txn).onerror=tt(A),x.oncomplete=function(){D&&A(null,D)}}var P,B=x.objectStore(et);S?(P=B.get(q)).onsuccess=function($){var I=$.target.result;I&&I._rev===S?B.put(d).onsuccess=function(){D={ok:!0,id:d._id,rev:d._rev},_.ctx&&A(null,D)}:A(ee(yt))}:((P=B.add(d)).onerror=function($){A(ee(yt)),$.preventDefault(),$.stopPropagation()},P.onsuccess=function(){D={ok:!0,id:d._id,rev:d._rev},_.ctx&&A(null,D)})},e._removeLocal=function(d,_,A){"function"==typeof _&&(A=_,_={});var S=_.ctx;if(!S){var q=We(i,[et],"readwrite");if(q.error)return A(q.error);(S=q.txn).oncomplete=function(){x&&A(null,x)}}var x,D=d._id,L=S.objectStore(et),B=L.get(D);B.onerror=tt(A),B.onsuccess=function(P){var $=P.target.result;$&&$._rev===d._rev?(L.delete(D),x={ok:!0,id:D,rev:"0-0"},_.ctx&&A(null,x)):A(ee(Ue))}},e._destroy=function(d,_){Ot.removeAllListeners(r);var A=wn.get(r);A&&A.result&&(A.result.close(),At.delete(r));var S=indexedDB.deleteDatabase(r);S.onsuccess=function(){wn.delete(r),qt()&&r in localStorage&&delete localStorage[r],_(null,{ok:!0})},S.onerror=tt(_)};var m=At.get(r);if(m)return i=m.idb,e._meta=m.global,Ze(function(){n(null,e)});var y=indexedDB.open(r,5);wn.set(r,y),y.onupgradeneeded=function(d){var _=d.target.result;if(d.oldVersion<1)return function u(d){var _=d.createObjectStore(ke,{keyPath:"id"});d.createObjectStore(Ie,{autoIncrement:!0}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0}),d.createObjectStore(Ge,{keyPath:"digest"}),d.createObjectStore(Ne,{keyPath:"id",autoIncrement:!1}),d.createObjectStore(vn),_.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),d.createObjectStore(et,{keyPath:"_id"});var A=d.createObjectStore(dt,{autoIncrement:!0});A.createIndex("seq","seq"),A.createIndex("digestSeq","digestSeq",{unique:!0})}(_);var A=d.currentTarget.transaction;d.oldVersion<3&&function w(d){d.createObjectStore(et,{keyPath:"_id"}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0})}(_),d.oldVersion<4&&function E(d){var _=d.createObjectStore(dt,{autoIncrement:!0});_.createIndex("seq","seq"),_.createIndex("digestSeq","digestSeq",{unique:!0})}(_);var S=[l,b,T,g],q=d.oldVersion;!function x(){var D=S[q-1];q++,D&&D(A,x)}()},y.onsuccess=function(d){(i=d.target.result).onversionchange=function(){i.close(),At.delete(r)},i.onabort=function(P){Ke("error","Database has a global failure",P.target.error),s=P.target.error,i.close(),At.delete(r)};var S,q,x,D,_=i.transaction([Ne,vn,ke],"readwrite"),A=!1;function L(){typeof x>"u"||!A||(e._meta={name:r,instanceId:D,blobSupport:x},At.set(r,{idb:i,global:e._meta}),n(null,e))}function B(){if(!(typeof q>"u"||typeof S>"u")){var P=r+"_id";P in S?D=S[P]:S[P]=D=Rt(),S.docCount=q,_.objectStore(Ne).put(S)}}_.objectStore(Ne).get(Ne).onsuccess=function(P){S=P.target.result||{id:Ne},B()},function Ks(e,t){e.objectStore(ke).index("deletedOrLocal").count(IDBKeyRange.only("0")).onsuccess=function(r){t(r.target.result)}}(_,function(P){q=P,B()}),mn||(mn=function As(e,t,n){return new Promise(function(r){var i=Xt([""]);let s;if("function"==typeof n){const u=n(i);s=e.objectStore(t).put(u)}else{const a=n;s=e.objectStore(t).put(i,a)}s.onsuccess=function(){var a=navigator.userAgent.match(/Chrome\/(\d+)/),u=navigator.userAgent.match(/Edge\//);r(u||!a||parseInt(a[1],10)>=43)},s.onerror=e.onabort=function(a){a.preventDefault(),a.stopPropagation(),r(!1)}}).catch(function(){return!1})}(_,vn,"key")),mn.then(function(P){x=P,L()}),_.oncomplete=function(){A=!0,L()},_.onabort=tt(n)},y.onerror=function(d){var _=d.target.error&&d.target.error.message;_?-1!==_.indexOf("stored database is a higher version")&&(_=new Error('This DB was created with the newer "indexeddb" adapter, but you are trying to open it with the older "idb" adapter')):_="Failed to open indexedDB, are you in private browsing mode?",Ke("error",_),n(ee(zt,_))}}(n,e,r)},t,n.constructor)}Ar.valid=function(){try{return typeof indexedDB<"u"&&typeof IDBKeyRange<"u"}catch{return!1}};const bn={};function An(e){const t=e.doc||e.ok,n=t&&t._attachments;n&&Object.keys(n).forEach(function(r){const i=n[r];i.data=Vt(i.data,i.content_type)})}function vt(e){return/^_design/.test(e)?"_design/"+encodeURIComponent(e.slice(8)):e.startsWith("_local/")?"_local/"+encodeURIComponent(e.slice(7)):encodeURIComponent(e)}function Sr(e){return e._attachments&&Object.keys(e._attachments)?Promise.all(Object.keys(e._attachments).map(function(t){const n=e._attachments[t];if(n.data&&"string"!=typeof n.data)return new Promise(function(r){en(n.data,r)}).then(function(r){n.data=r})})):Promise.resolve()}function Te(e,t){return It(e,e.db+"/"+t)}function It(e,t){return e.protocol+"://"+e.host+(e.port?":"+e.port:"")+"/"+e.path+(e.path?"/":"")+t}function jt(e){const t=Object.keys(e);return 0===t.length?"":"?"+t.map(n=>n+"="+encodeURIComponent(e[n])).join("&")}function Sn(e,t){const n=this,r=function Vs(e,t){if(function Zs(e){if(!e.prefix)return!1;const t=Gn(e.prefix).protocol;return"http"===t||"https"===t}(t)){const i=t.name.substr(t.prefix.length);e=t.prefix.replace(/\/?$/,"/")+encodeURIComponent(i)}const n=Gn(e);(n.user||n.password)&&(n.auth={username:n.user,password:n.password});const r=n.path.replace(/(^\/|\/$)/g,"").split("/");return n.db=r.pop(),-1===n.db.indexOf("%")&&(n.db=encodeURIComponent(n.db)),n.path=r.join("/"),n}(e.name,e),i=Te(r,"");e=z(e);const s=function(){var g=(0,G.A)(function*(m,y){if((y=y||{}).headers=y.headers||new wt,y.credentials="include",e.auth||r.auth){const A=e.auth||r.auth,q=St(unescape(encodeURIComponent(A.username+":"+A.password)));y.headers.set("Authorization","Basic "+q)}const d=e.headers||{};return Object.keys(d).forEach(function(A){y.headers.append(A,d[A])}),function ea(e){const t=typeof navigator<"u"&&navigator.userAgent?navigator.userAgent.toLowerCase():"",n=-1!==t.indexOf("msie"),r=-1!==t.indexOf("trident"),i=-1!==t.indexOf("edge");return(n||r||i)&&(!("method"in e)||"GET"===e.method)}(y)&&(m+=(-1===m.indexOf("?")?"?":"&")+"_nonce="+Date.now()),yield(e.fetch||ir)(m,y)});return function(y,d){return g.apply(this,arguments)}}();function a(g,m){return Se(g,function(...y){b().then(function(){return m.apply(this,y)}).catch(function(d){y.pop()(d)})}).bind(n)}function u(g,m){return l.apply(this,arguments)}function l(){return(l=(0,G.A)(function*(g,m){const y={};(m=m||{}).headers=m.headers||new wt,m.headers.get("Content-Type")||m.headers.set("Content-Type","application/json"),m.headers.get("Accept")||m.headers.set("Accept","application/json");const d=yield s(g,m);y.ok=d.ok,y.status=d.status;const _=yield d.json();if(y.data=_,!y.ok)throw y.data.status=y.status,mt(y.data);return Array.isArray(y.data)&&(y.data=y.data.map(function(A){return A.error||A.missing?mt(A):A})),y})).apply(this,arguments)}let w;function b(){return E.apply(this,arguments)}function E(){return(E=(0,G.A)(function*(){return e.skip_setup?Promise.resolve():w||(w=u(i).catch(function(g){return g&&g.status&&404===g.status?(Ut(404,"PouchDB is just detecting if the remote exists."),u(i,{method:"PUT"})):Promise.reject(g)}).catch(function(g){return!(!g||!g.status||412!==g.status)||Promise.reject(g)}),w.catch(function(){w=null}),w)})).apply(this,arguments)}function T(g){return g.split("/").map(encodeURIComponent).join("/")}Ze(function(){t(null,n)}),n._remote=!0,n.type=function(){return"http"},n.id=a("id",function(){var g=(0,G.A)(function*(m){let y;try{y=yield(yield s(It(r,""))).json()}catch{y={}}m(null,y&&y.uuid?y.uuid+r.db:Te(r,""))});return function(m){return g.apply(this,arguments)}}()),n.compact=a("compact",function(){var g=(0,G.A)(function*(m,y){"function"==typeof m&&(y=m,m={}),m=z(m),yield u(Te(r,"_compact"),{method:"POST"}),function d(){n.info(function(_,A){A&&!A.compact_running?y(null,{ok:!0}):setTimeout(d,m.interval||200)})}()});return function(m,y){return g.apply(this,arguments)}}()),n.bulkGet=Se("bulkGet",function(g,m){const y=this;function d(x){return _.apply(this,arguments)}function _(){return(_=(0,G.A)(function*(x){const D={};g.revs&&(D.revs=!0),g.attachments&&(D.attachments=!0),g.latest&&(D.latest=!0);try{const L=yield u(Te(r,"_bulk_get"+jt(D)),{method:"POST",body:JSON.stringify({docs:g.docs})});g.attachments&&g.binary&&L.data.results.forEach(function(B){B.docs.forEach(An)}),x(null,L.data)}catch(L){x(L)}})).apply(this,arguments)}function A(){const D=Math.ceil(g.docs.length/50);let L=0;const B=new Array(D);function P($){return function(I,V){B[$]=V.results,++L===D&&m(null,{results:B.flat()})}}for(let $=0;$<D;$++){const I=at(g,["revs","attachments","binary","latest"]);I.docs=g.docs.slice(50*$,Math.min(g.docs.length,50*($+1))),In(y,I,P($))}}const S=It(r,""),q=bn[S];"boolean"!=typeof q?d(function(x,D){x?(bn[S]=!1,Ut(x.status,"PouchDB is just detecting if the remote supports the _bulk_get API."),A()):(bn[S]=!0,m(null,D))}):q?d(m):A()}),n._info=function(){var g=(0,G.A)(function*(m){try{yield b();const d=yield(yield s(Te(r,""))).json();d.host=Te(r,""),m(null,d)}catch(y){m(y)}});return function(m){return g.apply(this,arguments)}}(),n.fetch=function(){var g=(0,G.A)(function*(m,y){yield b();const d="/"===m.substring(0,1)?It(r,m.substring(1)):Te(r,m);return s(d,y)});return function(m,y){return g.apply(this,arguments)}}(),n.get=a("get",function(){var g=(0,G.A)(function*(m,y,d){"function"==typeof y&&(d=y,y={});const _={};function A(x){const D=x._attachments,L=D&&Object.keys(D);if(!D||!L.length)return;function P(){return(P=(0,G.A)(function*(I){const V=D[I],F=vt(x._id)+"/"+T(I)+"?rev="+x._rev,M=yield s(Te(r,F));let Y,se;if(Y="buffer"in M?yield M.buffer():yield M.blob(),y.binary){const Z=Object.getOwnPropertyDescriptor(Y.__proto__,"type");(!Z||Z.set)&&(Y.type=V.content_type),se=Y}else se=yield new Promise(function(Z){en(Y,Z)});delete V.stub,delete V.length,V.data=se})).apply(this,arguments)}const $=L.map(function(I){return function(){return function B(I){return P.apply(this,arguments)}(I)}});return function Ws(e,t){return new Promise(function(n,r){var l,i=0,s=0,a=0,u=e.length;function b(){++a===u?l?r(l):n():g()}function E(){i--,b()}function T(m){i--,l=l||m,b()}function g(){for(;i<t&&s<u;)i++,e[s++]().then(E,T)}g()})}($,5)}(y=z(y)).revs&&(_.revs=!0),y.revs_info&&(_.revs_info=!0),y.latest&&(_.latest=!0),y.open_revs&&("all"!==y.open_revs&&(y.open_revs=JSON.stringify(y.open_revs)),_.open_revs=y.open_revs),y.rev&&(_.rev=y.rev),y.conflicts&&(_.conflicts=y.conflicts),y.update_seq&&(_.update_seq=y.update_seq),m=vt(m);const q=Te(r,m+jt(_));try{const x=yield u(q);y.attachments&&(yield function S(x){return Array.isArray(x)?Promise.all(x.map(function(D){if(D.ok)return A(D.ok)})):A(x)}(x.data)),d(null,x.data)}catch(x){x.docId=m,d(x)}});return function(m,y,d){return g.apply(this,arguments)}}()),n.remove=a("remove",function(){var g=(0,G.A)(function*(m,y,d,_){let A;"string"==typeof y?(A={_id:m,_rev:y},"function"==typeof d&&(_=d,d={})):(A=m,"function"==typeof y?(_=y,d={}):(_=d,d=y));const S=A._rev||d.rev,q=Te(r,vt(A._id))+"?rev="+S;try{_(null,(yield u(q,{method:"DELETE"})).data)}catch(x){_(x)}});return function(m,y,d,_){return g.apply(this,arguments)}}()),n.getAttachment=a("getAttachment",function(){var g=(0,G.A)(function*(m,y,d,_){"function"==typeof d&&(_=d,d={});const A=d.rev?"?rev="+d.rev:"",S=Te(r,vt(m))+"/"+T(y)+A;let q;try{const x=yield s(S,{method:"GET"});if(!x.ok)throw x;let D;if(q=x.headers.get("content-type"),D=typeof process<"u"&&!process.browser&&"function"==typeof x.buffer?yield x.buffer():yield x.blob(),typeof process<"u"&&!process.browser){const L=Object.getOwnPropertyDescriptor(D.__proto__,"type");(!L||L.set)&&(D.type=q)}_(null,D)}catch(x){_(x)}});return function(m,y,d,_){return g.apply(this,arguments)}}()),n.removeAttachment=a("removeAttachment",function(){var g=(0,G.A)(function*(m,y,d,_){const A=Te(r,vt(m)+"/"+T(y))+"?rev="+d;try{_(null,(yield u(A,{method:"DELETE"})).data)}catch(S){_(S)}});return function(m,y,d,_){return g.apply(this,arguments)}}()),n.putAttachment=a("putAttachment",function(){var g=(0,G.A)(function*(m,y,d,_,A,S){"function"==typeof A&&(S=A,A=_,_=d,d=null);const q=vt(m)+"/"+T(y);let x=Te(r,q);if(d&&(x+="?rev="+d),"string"==typeof _){let D;try{D=Yt(_)}catch{return S(ee(Nn,"Attachment is not a valid base64 string"))}_=D?Zt(D,A):""}try{S(null,(yield u(x,{headers:new wt({"Content-Type":A}),method:"PUT",body:_})).data)}catch(D){S(D)}});return function(m,y,d,_,A,S){return g.apply(this,arguments)}}()),n._bulkDocs=function(){var g=(0,G.A)(function*(m,y,d){m.new_edits=y.new_edits;try{yield b(),yield Promise.all(m.docs.map(Sr)),d(null,(yield u(Te(r,"_bulk_docs"),{method:"POST",body:JSON.stringify(m)})).data)}catch(_){d(_)}});return function(m,y,d){return g.apply(this,arguments)}}(),n._put=function(){var g=(0,G.A)(function*(m,y,d){try{yield b(),yield Sr(m),d(null,(yield u(Te(r,vt(m._id)),{method:"PUT",body:JSON.stringify(m)})).data)}catch(_){_.docId=m&&m._id,d(_)}});return function(m,y,d){return g.apply(this,arguments)}}(),n.allDocs=a("allDocs",function(){var g=(0,G.A)(function*(m,y){"function"==typeof m&&(y=m,m={});const d={};let _,A="GET";(m=z(m)).conflicts&&(d.conflicts=!0),m.update_seq&&(d.update_seq=!0),m.descending&&(d.descending=!0),m.include_docs&&(d.include_docs=!0),m.attachments&&(d.attachments=!0),m.key&&(d.key=JSON.stringify(m.key)),m.start_key&&(m.startkey=m.start_key),m.startkey&&(d.startkey=JSON.stringify(m.startkey)),m.end_key&&(m.endkey=m.end_key),m.endkey&&(d.endkey=JSON.stringify(m.endkey)),typeof m.inclusive_end<"u"&&(d.inclusive_end=!!m.inclusive_end),typeof m.limit<"u"&&(d.limit=m.limit),typeof m.skip<"u"&&(d.skip=m.skip);const S=jt(d);typeof m.keys<"u"&&(A="POST",_={keys:m.keys});try{const q=yield u(Te(r,"_all_docs"+S),{method:A,body:JSON.stringify(_)});m.include_docs&&m.attachments&&m.binary&&q.data.rows.forEach(An),y(null,q.data)}catch(q){y(q)}});return function(m,y){return g.apply(this,arguments)}}()),n._changes=function(g){const m="batch_size"in g?g.batch_size:25;(g=z(g)).continuous&&!("heartbeat"in g)&&(g.heartbeat=1e4);let y="timeout"in g?g.timeout:3e4;"timeout"in g&&g.timeout&&y-g.timeout<5e3&&(y=g.timeout+5e3),"heartbeat"in g&&g.heartbeat&&y-g.heartbeat<5e3&&(y=g.heartbeat+5e3);const d={};"timeout"in g&&g.timeout&&(d.timeout=g.timeout);const _=typeof g.limit<"u"&&g.limit;let A=_;if(g.style&&(d.style=g.style),(g.include_docs||g.filter&&"function"==typeof g.filter)&&(d.include_docs=!0),g.attachments&&(d.attachments=!0),g.continuous&&(d.feed="longpoll"),g.seq_interval&&(d.seq_interval=g.seq_interval),g.conflicts&&(d.conflicts=!0),g.descending&&(d.descending=!0),g.update_seq&&(d.update_seq=!0),"heartbeat"in g&&g.heartbeat&&(d.heartbeat=g.heartbeat),g.filter&&"string"==typeof g.filter&&(d.filter=g.filter),g.view&&"string"==typeof g.view&&(d.filter="_view",d.view=g.view),g.query_params&&"object"==typeof g.query_params)for(const $ in g.query_params)Object.prototype.hasOwnProperty.call(g.query_params,$)&&(d[$]=g.query_params[$]);let q,S="GET";g.doc_ids?(d.filter="_doc_ids",S="POST",q={doc_ids:g.doc_ids}):g.selector&&(d.filter="_selector",S="POST",q={selector:g.selector});const x=new AbortController;let D;const L=function(){var $=(0,G.A)(function*(I,V){if(g.aborted)return;d.since=I,"object"==typeof d.since&&(d.since=JSON.stringify(d.since)),g.descending?_&&(d.limit=A):d.limit=!_||A>m?m:A;const F=Te(r,"_changes"+jt(d)),M={signal:x.signal,method:S,body:JSON.stringify(q)};if(D=I,!g.aborted)try{yield b(),V(null,(yield u(F,M)).data)}catch(Y){V(Y)}});return function(V,F){return $.apply(this,arguments)}}(),B={results:[]},P=function($,I){if(g.aborted)return;let V=0;if(I&&I.results){V=I.results.length,B.last_seq=I.last_seq;let M=null,Y=null;"number"==typeof I.pending&&(M=I.pending),("string"==typeof B.last_seq||"number"==typeof B.last_seq)&&(Y=B.last_seq),I.results=I.results.filter(function(Z){A--;const ue=Qt(g)(Z);return ue&&(g.include_docs&&g.attachments&&g.binary&&An(Z),g.return_docs&&B.results.push(Z),g.onChange(Z,M,Y)),ue})}else if($)return g.aborted=!0,void g.complete($);I&&I.last_seq&&(D=I.last_seq),(!g.continuous||_&&A<=0)&&(_&&A<=0||I&&V<m||g.descending)?g.complete(null,B):Ze(function(){L(D,P)})};return L(g.since||0,P),{cancel:function(){g.aborted=!0,x.abort()}}},n.revsDiff=a("revsDiff",function(){var g=(0,G.A)(function*(m,y,d){"function"==typeof y&&(d=y,y={});try{d(null,(yield u(Te(r,"_revs_diff"),{method:"POST",body:JSON.stringify(m)})).data)}catch(_){d(_)}});return function(m,y,d){return g.apply(this,arguments)}}()),n._close=function(g){g()},n._destroy=function(){var g=(0,G.A)(function*(m,y){try{y(null,yield u(Te(r,""),{method:"DELETE"}))}catch(d){404===d.status?y(null,{ok:!0}):y(d)}});return function(m,y){return g.apply(this,arguments)}}()}Sn.valid=function(){return!0};class _t extends Error{constructor(t){super(),this.status=400,this.name="query_parse_error",this.message=t,this.error=!0;try{Error.captureStackTrace(this,_t)}catch{}}}class Nt extends Error{constructor(t){super(),this.status=404,this.name="not_found",this.message=t,this.error=!0;try{Error.captureStackTrace(this,Nt)}catch{}}}class $t extends Error{constructor(t){super(),this.status=500,this.name="invalid_value",this.message=t,this.error=!0;try{Error.captureStackTrace(this,$t)}catch{}}}function xr(e,t){return t&&e.then(function(n){Ze(function(){t(null,n)})},function(n){Ze(function(){t(n)})}),e}function xn(e,t){return function(){var n=arguments,r=this;return e.add(function(){return t.apply(r,n)})}}function Cr(e){var t=new Set(e),n=new Array(t.size),r=-1;return t.forEach(function(i){n[++r]=i}),n}function Cn(e){var t=new Array(e.size),n=-1;return e.forEach(function(r,i){t[++n]=i}),t}function Or(e){return new $t("builtin "+e+" function requires map values to be numbers or number arrays")}function On(e){for(var t=0,n=0,r=e.length;n<r;n++){var i=e[n];if("number"!=typeof i){if(!Array.isArray(i))throw Or("_sum");t="number"==typeof t?[t]:t;for(var s=0,a=i.length;s<a;s++){var u=i[s];if("number"!=typeof u)throw Or("_sum");typeof t[s]>"u"?t.push(u):t[s]+=u}}else"number"==typeof t?t+=i:t[0]+=i}return t}var ia=Ke.bind(null,"log"),sa=Array.isArray,aa=JSON.parse;function Er(e,t){return Ht("return ("+e.replace(/;\s*$/,"")+");",{emit:t,sum:On,log:ia,isArray:sa,toJSON:aa})}class En{constructor(){this.promise=Promise.resolve()}add(t){return this.promise=this.promise.catch(()=>{}).then(()=>t()),this.promise}finish(){return this.promise}}function qr(e){if(!e)return"undefined";switch(typeof e){case"function":case"string":return e.toString();default:return JSON.stringify(e)}}function Dr(e,t,n,r,i,s){return qn.apply(this,arguments)}function qn(){return qn=(0,G.A)(function*(e,t,n,r,i,s){const a=function oa(e,t){return qr(e)+qr(t)+"undefined"}(n,r);let u;if(!i&&(u=e._cachedViews=e._cachedViews||{},u[a]))return u[a];const l=e.info().then(function(){var w=(0,G.A)(function*(b){const E=b.db_name+"-mrview-"+(i?"temp":Qn(a));yield Tt(e,"_local/"+s,function T(_){_.views=_.views||{};let A=t;-1===A.indexOf("/")&&(A=t+"/"+t);const S=_.views[A]=_.views[A]||{};if(!S[E])return S[E]=!0,_});const m=(yield e.registerDependentDatabase(E)).db;m.auto_compaction=!0;const y={name:E,db:m,sourceDB:e,adapter:e.adapter,mapFun:n,reduceFun:r};let d;try{d=yield y.db.get("_local/lastSeq")}catch(_){if(404!==_.status)throw _}return y.seq=d?d.seq:0,u&&y.db.once("destroyed",function(){delete u[a]}),y});return function(b){return w.apply(this,arguments)}}());return u&&(u[a]=l),l}),qn.apply(this,arguments)}const kr={},Tr=new En;function Dn(e){return-1===e.indexOf("/")?[e,e]:e.split("/")}function Rr(e,t,n){try{e.emit("error",t)}catch{Ke("error","The user's map/reduce function threw an uncaught error.\nYou can debug this error by doing:\nmyDatabase.on('error', function (err) { debugger; });\nPlease double-check your map/reduce function."),Ke("error",t,n)}}var kn__sum=function(e,t){return On(t)},kn__count=function(e,t){return t.length},kn__stats=function(e,t){return{sum:On(t),min:Math.min.apply(null,t),max:Math.max.apply(null,t),count:t.length,sumsqr:function n(r){for(var i=0,s=0,a=r.length;s<a;s++){var u=r[s];i+=u*u}return i}(t)}},Pr=function fa(e,t,n,r){function i(h,p,C){try{p(C)}catch(R){Rr(h,R,{fun:p,doc:C})}}function s(h,p,C,R,j){try{return{output:p(C,R,j)}}catch(W){return Rr(h,W,{fun:p,keys:C,values:R,rereduce:j}),{error:W}}}function a(h,p){const C=De(h.key,p.key);return 0!==C?C:De(h.value,p.value)}function u(h,p,C){return C=C||0,"number"==typeof p?h.slice(C,p+C):C>0?h.slice(C):h}function l(h){const p=h.value;return p&&"object"==typeof p&&p._id||h.id}function b(h){return function(p){return h.include_docs&&h.attachments&&h.binary&&function w(h){for(const p of h.rows){const C=p.doc&&p.doc._attachments;if(C)for(const R of Object.keys(C)){const j=C[R];C[R].data=Vt(j.data,j.content_type)}}}(p),p}}function E(h,p,C,R){let j=p[h];typeof j<"u"&&(R&&(j=encodeURIComponent(JSON.stringify(j))),C.push(h+"="+j))}function T(h){if(typeof h<"u"){const p=Number(h);return isNaN(p)||p!==parseInt(h,10)?h:p}}function m(h){if(h){if("number"!=typeof h)return new _t(`Invalid value for integer: "${h}"`);if(h<0)return new _t(`Invalid value for positive integer: "${h}"`)}}function y(h,p){const C=h.descending?"endkey":"startkey",R=h.descending?"startkey":"endkey";if(typeof h[C]<"u"&&typeof h[R]<"u"&&De(h[C],h[R])>0)throw new _t("No rows can match your key range, reverse your start_key and end_key or set {descending : true}");if(p.reduce&&!1!==h.reduce){if(h.include_docs)throw new _t("{include_docs:true} is invalid for reduce");if(h.keys&&h.keys.length>1&&!h.group&&!h.group_level)throw new _t("Multi-key fetches for reduce views must use {group: true}")}for(const j of["group_level","limit","skip"]){const W=m(h[j]);if(W)throw W}}function _(){return(_=(0,G.A)(function*(h,p,C){let j,oe,R=[],W="GET";if(E("reduce",C,R),E("include_docs",C,R),E("attachments",C,R),E("limit",C,R),E("descending",C,R),E("group",C,R),E("group_level",C,R),E("skip",C,R),E("stale",C,R),E("conflicts",C,R),E("startkey",C,R,!0),E("start_key",C,R,!0),E("endkey",C,R,!0),E("end_key",C,R,!0),E("inclusive_end",C,R),E("key",C,R,!0),E("update_seq",C,R),R=R.join("&"),R=""===R?"":"?"+R,typeof C.keys<"u"){const re=`keys=${encodeURIComponent(JSON.stringify(C.keys))}`;re.length+R.length+1<=2e3?R+=("?"===R[0]?"&":"?")+re:(W="POST","string"==typeof p?j={keys:C.keys}:p.keys=C.keys)}if("string"==typeof p){const K=Dn(p),re=yield h.fetch("_design/"+K[0]+"/_view/"+K[1]+R,{headers:new wt({"Content-Type":"application/json"}),method:W,body:JSON.stringify(j)});oe=re.ok;const fe=yield re.json();if(!oe)throw fe.status=re.status,mt(fe);for(const pe of fe.rows)if(pe.value&&pe.value.error&&"builtin_reduce_error"===pe.value.error)throw new Error(pe.reason);return new Promise(function(pe){pe(fe)}).then(b(C))}j=j||{};for(const K of Object.keys(p))j[K]=Array.isArray(p[K])?p[K]:p[K].toString();const X=yield h.fetch("_temp_view"+R,{headers:new wt({"Content-Type":"application/json"}),method:"POST",body:JSON.stringify(j)});oe=X.ok;const H=yield X.json();if(!oe)throw H.status=X.status,mt(H);return new Promise(function(K){K(H)}).then(b(C))})).apply(this,arguments)}function q(h){return function(p){if(404===p.status)return h;throw p}}function D(){return D=(0,G.A)(function*(h,p,C){const R="_local/doc_"+h,j={_id:R,keys:[]},W=C.get(h),oe=W[0],X=W[1],fe=yield function H(){return function ca(e){return 1===e.length&&/^1-/.test(e[0].rev)}(X)?Promise.resolve(j):p.db.get(R).catch(q(j))}();return function re(ye,Oe){const rt=[],gt=new Set;for(const pt of Oe.rows){const de=pt.doc;if(de&&(rt.push(de),gt.add(de._id),de._deleted=!oe.has(de._id),!de._deleted)){const Ce=oe.get(de._id);"value"in Ce&&(de.value=Ce.value)}}const Mt=Cn(oe);for(const pt of Mt)if(!gt.has(pt)){const de={_id:pt},Ce=oe.get(pt);"value"in Ce&&(de.value=Ce.value),rt.push(de)}return ye.keys=Cr(Mt.concat(ye.keys)),rt.push(ye),rt}(fe,yield function K(ye){return ye.keys.length?p.db.allDocs({keys:ye.keys,include_docs:!0}):Promise.resolve({rows:[]})}(fe))}),D.apply(this,arguments)}function P(h){const p="string"==typeof h?h:h.name;let C=kr[p];return C||(C=kr[p]=new En),C}function $(h,p){return I.apply(this,arguments)}function I(){return I=(0,G.A)(function*(h,p){return xn(P(h),function(){return function V(h,p){return F.apply(this,arguments)}(h,p)})()}),I.apply(this,arguments)}function F(){return F=(0,G.A)(function*(h,p){let C,R,j;const oe=t(h.mapFun,function W(de,Ce){const qe={id:R._id,key:ft(de)};typeof Ce<"u"&&null!==Ce&&(qe.value=ft(Ce)),C.push(qe)});let X=h.seq||0,re=0;h.sourceDB.emit("indexing",{view:h.name,indexed_docs:re});const pe=new En;function ye(){return Oe.apply(this,arguments)}function Oe(){return(Oe=(0,G.A)(function*(){const de=yield h.sourceDB.changes({return_docs:!0,conflicts:!0,include_docs:!0,style:"all_docs",since:X,limit:p.changes_batch_size}),Ce=yield function rt(){return h.db.get("_local/purgeSeq").then(function(de){return de.purgeSeq}).catch(q(-1)).then(function(de){return h.sourceDB.get("_local/purges").then(function(Ce){const qe=Ce.purges.filter(function(Je,Le){return Le>de}).map(Je=>Je.docId),Xe=qe.filter(function(Je,Le){return qe.indexOf(Je)===Le});return Promise.all(Xe.map(function(Je){return h.sourceDB.get(Je).then(function(Le){return{docId:Je,doc:Le}}).catch(q({docId:Je}))}))}).catch(q([]))})}();return function gt(de,Ce){const qe=de.results;if(!qe.length&&!Ce.length)return;for(const Le of Ce)if(qe.findIndex(function(Et){return Et.id===Le.docId})<0){const Et={_id:Le.docId,doc:{_id:Le.docId,_deleted:1},changes:[]};Le.doc&&(Et.doc=Le.doc,Et.changes.push({rev:Le.doc._rev})),qe.push(Et)}const Xe=function Mt(de){const Ce=new Map;for(const qe of de){if("_"!==qe.doc._id[0]){C=[],R=qe.doc,R._deleted||i(h.sourceDB,oe,R),C.sort(a);const Xe=pt(C);Ce.set(qe.doc._id,[Xe,qe.changes])}X=qe.seq}return Ce}(qe);pe.add(function K(de,Ce){return function(){return function B(h,p,C){var R="_local/lastSeq";return h.db.get(R).catch(q({_id:R,seq:0})).then(function(j){var W=Cn(p);return Promise.all(W.map(function(oe){return function x(h,p,C){return D.apply(this,arguments)}(oe,h,p)})).then(function(oe){var X=oe.flat();return j.seq=C,X.push(j),h.db.bulkDocs({docs:X})}).then(()=>function L(h){return h.sourceDB.get("_local/purges").then(function(p){const C=p.purgeSeq;return h.db.get("_local/purgeSeq").then(function(R){return R._rev}).catch(q(void 0)).then(function(R){return h.db.put({_id:"_local/purgeSeq",_rev:R,purgeSeq:C})})}).catch(function(p){if(404!==p.status)throw p})}(h))})}(h,de,Ce)}}(Xe,X)),re+=qe.length;return h.sourceDB.emit("indexing",{view:h.name,last_seq:de.last_seq,results_count:qe.length,indexed_docs:re}),h.sourceDB.activeTasks.update(j,{completed_items:re}),qe.length<p.changes_batch_size?void 0:ye()}(de,Ce)})).apply(this,arguments)}function pt(de){const Ce=new Map;let qe;for(let Xe=0,Je=de.length;Xe<Je;Xe++){const Le=de[Xe],Ln=[Le.key,Le.id];Xe>0&&0===De(Le.key,qe)&&Ln.push(Xe),Ce.set(Qe(Ln),Le),qe=Le.key}return Ce}try{yield function H(){return h.sourceDB.info().then(function(de){j=h.sourceDB.activeTasks.add({name:"view_indexing",total_items:de.update_seq-X})})}(),yield ye(),yield pe.finish(),h.seq=X,h.sourceDB.activeTasks.remove(j)}catch(de){h.sourceDB.activeTasks.remove(j,de)}}),F.apply(this,arguments)}function Y(h,p){return xn(P(h),function(){return function se(h,p){return Z.apply(this,arguments)}(h,p)})()}function Z(){return Z=(0,G.A)(function*(h,p){let C;const R=h.reduceFun&&!1!==p.reduce,j=p.skip||0;function W(K){return oe.apply(this,arguments)}function oe(){return oe=(0,G.A)(function*(K){K.include_docs=!0;const re=yield h.db.allDocs(K);return C=re.total_rows,re.rows.map(function(fe){if("value"in fe.doc&&"object"==typeof fe.doc.value&&null!==fe.doc.value){const ye=Object.keys(fe.doc.value).sort(),Oe=["id","key","value"];if(!(ye<Oe||ye>Oe))return fe.doc.value}const pe=function ts(e){for(var t=[],n=[],r=0;;){var i=e[r++];if("\0"!==i)switch(i){case"1":t.push(null);break;case"2":t.push("1"===e[r]),r++;break;case"3":var s=Vi(e,r);t.push(s.num),r+=s.length;break;case"4":for(var a="";;){var u=e[r];if("\0"===u)break;a+=u,r++}a=a.replace(/\u0001\u0001/g,"\0").replace(/\u0001\u0002/g,"\x01").replace(/\u0002\u0002/g,"\x02"),t.push(a);break;case"5":var l={element:[],index:t.length};t.push(l.element),n.push(l);break;case"6":var w={element:{},index:t.length};t.push(w.element),n.push(w);break;default:throw new Error("bad collationIndex or unexpectedly reached end of input: "+i)}else{if(1===t.length)return t.pop();es(t,n)}}}(fe.doc._id);return{key:pe[0],id:pe[1],value:"value"in fe.doc?fe.doc.value:null}})}),oe.apply(this,arguments)}function X(K){return H.apply(this,arguments)}function H(){return H=(0,G.A)(function*(K){let re;if(re=R?function M(h,p,C){0===C.group_level&&delete C.group_level;const R=C.group||C.group_level,j=n(h.reduceFun),W=[],oe=isNaN(C.group_level)?Number.POSITIVE_INFINITY:C.group_level;for(const X of p){const H=W[W.length-1];let K=R?X.key:null;R&&Array.isArray(K)&&(K=K.slice(0,oe)),H&&0===De(H.groupKey,K)?(H.keys.push([X.key,X.id]),H.values.push(X.value)):W.push({keys:[[X.key,X.id]],values:[X.value],groupKey:K})}p=[];for(const X of W){const H=s(h.sourceDB,j,X.keys,X.values,!1);if(H.error&&H.error instanceof $t)throw H.error;p.push({value:H.error?null:H.output,key:X.groupKey})}return{rows:u(p,C.limit,C.skip)}}(h,K,p):typeof p.keys>"u"?{total_rows:C,offset:j,rows:K}:{total_rows:C,offset:j,rows:u(K,p.limit,p.skip)},p.update_seq&&(re.update_seq=h.seq),p.include_docs){const fe=Cr(K.map(l)),pe=yield h.sourceDB.allDocs({keys:fe,include_docs:!0,conflicts:p.conflicts,attachments:p.attachments,binary:p.binary}),ye=new Map;for(const Oe of pe.rows)ye.set(Oe.id,Oe.doc);for(const Oe of K){const rt=l(Oe),gt=ye.get(rt);gt&&(Oe.doc=gt)}}return re}),H.apply(this,arguments)}if(typeof p.keys<"u"&&!p.keys.length&&(p.limit=0,delete p.keys),typeof p.keys<"u"){const re=p.keys.map(function(ye){const Oe={startkey:Qe([ye]),endkey:Qe([ye,{}])};return p.update_seq&&(Oe.update_seq=!0),W(Oe)});return X((yield Promise.all(re)).flat())}{const K={descending:p.descending};let re,fe;if(p.update_seq&&(K.update_seq=!0),"start_key"in p&&(re=p.start_key),"startkey"in p&&(re=p.startkey),"end_key"in p&&(fe=p.end_key),"endkey"in p&&(fe=p.endkey),typeof re<"u"&&(K.startkey=Qe(p.descending?[re,{}]:[re])),typeof fe<"u"){let ye=!1!==p.inclusive_end;p.descending&&(ye=!ye),K.endkey=Qe(ye?[fe,{}]:[fe])}if(typeof p.key<"u"){const ye=Qe([p.key]),Oe=Qe([p.key,{}]);K.descending?(K.endkey=ye,K.startkey=Oe):(K.startkey=ye,K.endkey=Oe)}return R||("number"==typeof p.limit&&(K.limit=p.limit),K.skip=j),X(yield W(K))}}),Z.apply(this,arguments)}function Ee(){return(Ee=(0,G.A)(function*(h){return(yield h.fetch("_view_cleanup",{headers:new wt({"Content-Type":"application/json"}),method:"POST"})).json()})).apply(this,arguments)}function Q(){return(Q=(0,G.A)(function*(h){try{const p=yield h.get("_local/"+e),C=new Map;for(const H of Object.keys(p.views)){const K=Dn(H),re="_design/"+K[0],fe=K[1];let pe=C.get(re);pe||(pe=new Set,C.set(re,pe)),pe.add(fe)}const R={keys:Cn(C),include_docs:!0},j=yield h.allDocs(R),W={};for(const H of j.rows){const K=H.key.substring(8);for(const re of C.get(H.key)){let fe=K+"/"+re;p.views[fe]||(fe=re);const pe=Object.keys(p.views[fe]),ye=H.doc&&H.doc.views&&H.doc.views[re];for(const Oe of pe)W[Oe]=W[Oe]||ye}}const X=Object.keys(W).filter(function(H){return!W[H]}).map(function(H){return xn(P(H),function(){return new h.constructor(H,h.__opts).destroy()})()});return Promise.all(X).then(function(){return{ok:!0}})}catch(p){if(404===p.status)return{ok:!0};throw p}})).apply(this,arguments)}function he(){return he=(0,G.A)(function*(h,p,C){if("function"==typeof h._query)return function A(h,p,C){return new Promise(function(R,j){h._query(p,C,function(W,oe){if(W)return j(W);R(oe)})})}(h,p,C);if(Ve(h))return function d(h,p,C){return _.apply(this,arguments)}(h,p,C);const R={changes_batch_size:h.__opts.view_update_changes_batch_size||50};if("string"!=typeof p)return y(C,p),Tr.add((0,G.A)(function*(){const j=yield Dr(h,"temp_view/temp_view",p.map,p.reduce,!0,e);return function ra(e,t){return e.then(function(n){return t().then(function(){return n})},function(n){return t().then(function(){throw n})})}($(j,R).then(function(){return Y(j,C)}),function(){return j.db.destroy()})})),Tr.finish();{const j=p,W=Dn(j),oe=W[0],X=W[1],H=yield h.get("_design/"+oe);if(!(p=H.views&&H.views[X]))throw new Nt(`ddoc ${H._id} has no view named ${X}`);r(H,X),y(C,p);const K=yield Dr(h,j,p.map,p.reduce,!1,e);return"ok"===C.stale||"update_after"===C.stale?("update_after"===C.stale&&Ze(function(){$(K,R)}),Y(K,C)):(yield $(K,R),Y(K,C))}}),he.apply(this,arguments)}return{query:function xe(h,p,C){const R=this;"function"==typeof p&&(C=p,p={}),p=p?function g(h){return h.group_level=T(h.group_level),h.limit=T(h.limit),h.skip=T(h.skip),h}(p):{},"function"==typeof h&&(h={map:h});const j=Promise.resolve().then(function(){return function ae(h,p,C){return he.apply(this,arguments)}(R,h,p)});return xr(j,C),j},viewCleanup:function na(e){return function(...t){var n=t.pop(),r=e.apply(this,t);return"function"==typeof n&&xr(r,n),r}}(function(){const h=this;return"function"==typeof h._viewCleanup?function S(h){return new Promise(function(p,C){h._viewCleanup(function(R,j){if(R)return C(R);p(j)})})}(h):Ve(h)?function ue(h){return Ee.apply(this,arguments)}(h):function Ye(h){return Q.apply(this,arguments)}(h)})}}("mrviews",function da(e,t){if("function"==typeof e&&2===e.length){var n=e;return function(r){return n(r,t)}}return Er(e.toString(),t)},function ha(e){var t=e.toString();return function la(e){if(/^_sum/.test(e))return kn__sum;if(/^_count/.test(e))return kn__count;if(/^_stats/.test(e))return kn__stats;if(/^_/.test(e))throw new Error(e+" is not a supported reduce function.")}(t)||Er(t)},function va(e,t){var n=e.views&&e.views[t];if("string"!=typeof n.map)throw new Nt("ddoc "+e._id+" has no string view named "+t+", instead found object of type: "+typeof n.map)}),ya={query:function ga(e,t,n){return Pr.query.call(this,e,t,n)},viewCleanup:function pa(e){return Pr.viewCleanup.call(this,e)}};function Lr(e,t){var n=Object.keys(t._attachments);return Promise.all(n.map(function(r){return e.getAttachment(t._id,r,{rev:t._rev})}))}var Ir="pouchdb";function Tn(e,t,n,r,i){return e.get(t).catch(function(s){if(404===s.status)return("http"===e.adapter||"https"===e.adapter)&&Ut(404,"PouchDB is just checking if a remote checkpoint exists."),{session_id:r,_id:t,history:[],replicator:Ir,version:1};throw s}).then(function(s){if(!i.cancelled&&s.last_seq!==n)return s.history=(s.history||[]).filter(function(a){return a.session_id!==r}),s.history.unshift({last_seq:n,session_id:r}),s.history=s.history.slice(0,5),s.version=1,s.replicator=Ir,s.session_id=r,s.last_seq=n,e.put(s).catch(function(a){if(409===a.status)return Tn(e,t,n,r,i);throw a})})}class jr{constructor(t,n,r,i,s={writeSourceCheckpoint:!0,writeTargetCheckpoint:!0}){this.src=t,this.target=n,this.id=r,this.returnValue=i,this.opts=s,typeof s.writeSourceCheckpoint>"u"&&(s.writeSourceCheckpoint=!0),typeof s.writeTargetCheckpoint>"u"&&(s.writeTargetCheckpoint=!0)}writeCheckpoint(t,n){var r=this;return this.updateTarget(t,n).then(function(){return r.updateSource(t,n)})}updateTarget(t,n){return this.opts.writeTargetCheckpoint?Tn(this.target,this.id,t,n,this.returnValue):Promise.resolve(!0)}updateSource(t,n){if(this.opts.writeSourceCheckpoint){var r=this;return Tn(this.src,this.id,t,n,this.returnValue).catch(function(i){if(Fr(i))return r.opts.writeSourceCheckpoint=!1,!0;throw i})}return Promise.resolve(!0)}getCheckpoint(){var t=this;return t.opts.writeSourceCheckpoint||t.opts.writeTargetCheckpoint?t.opts&&t.opts.writeSourceCheckpoint&&!t.opts.writeTargetCheckpoint?t.src.get(t.id).then(function(n){return n.last_seq||0}).catch(function(n){if(404!==n.status)throw n;return 0}):t.target.get(t.id).then(function(n){return t.opts&&t.opts.writeTargetCheckpoint&&!t.opts.writeSourceCheckpoint?n.last_seq||0:t.src.get(t.id).then(function(r){return n.version!==r.version?0:(i=n.version?n.version.toString():"undefined")in Nr?Nr[i](n,r):0;var i},function(r){if(404===r.status&&n.last_seq)return t.src.put({_id:t.id,last_seq:0}).then(function(){return 0},function(i){return Fr(i)?(t.opts.writeSourceCheckpoint=!1,n.last_seq):0});throw r})}).catch(function(n){if(404!==n.status)throw n;return 0}):Promise.resolve(0)}}var Nr={undefined:function(e,t){return 0===De(e.last_seq,t.last_seq)?t.last_seq:0},1:function(e,t){return function xa(e,t){return e.session_id===t.session_id?{last_seq:e.last_seq,history:e.history}:$r(e.history,t.history)}(t,e).last_seq}};function $r(e,t){var n=e[0],r=e.slice(1),i=t[0],s=t.slice(1);return n&&0!==t.length?Rn(n.session_id,t)?{last_seq:n.last_seq,history:e}:Rn(i.session_id,r)?{last_seq:i.last_seq,history:s}:$r(r,s):{last_seq:0,history:[]}}function Rn(e,t){var n=t[0],r=t.slice(1);return!(!e||0===t.length)&&(e===n.session_id||Rn(e,r))}function Fr(e){return"number"==typeof e.status&&4===Math.floor(e.status/100)}function Mr(e,t,n,r,i){return this instanceof jr?Mr:new jr(e,t,n,r,i)}var Kr=0;function Ur(e,t,n,r,i){var a,x,B,s=[],u={seq:0,changes:[],docs:[]},l=!1,w=!1,b=!1,E=0,T=0,g=n.continuous||n.live||!1,m=n.batch_size||100,y=n.batches_limit||10,d=n.style||"all_docs",_=!1,A=n.doc_ids,S=n.selector,D=[],L=Rt();i=i||{ok:!0,start_time:(new Date).toISOString(),docs_read:0,docs_written:0,doc_write_failures:0,errors:[]};var P={};function $(){return x?Promise.resolve():function Ea(e,t,n){var r=n.doc_ids?n.doc_ids.sort(De):"",i=n.filter?n.filter.toString():"",s="",a="",u="";return n.selector&&(u=JSON.stringify(n.selector)),n.filter&&n.query_params&&(s=JSON.stringify(function Oa(e){return Object.keys(e).sort(De).reduce(function(t,n){return t[n]=e[n],t},{})}(n.query_params))),n.filter&&"_view"===n.filter&&(a=n.view.toString()),Promise.all([e.id(),t.id()]).then(function(l){var w=l[0]+l[1]+i+a+s+r+u;return new Promise(function(b){tn(w,b)})}).then(function(l){return"_local/"+l.replace(/\//g,".").replace(/\+/g,"_")})}(e,t,n).then(function(h){x=new Mr(e,t,h,r,!1===n.checkpoint?{writeSourceCheckpoint:!1,writeTargetCheckpoint:!1}:"source"===n.checkpoint?{writeSourceCheckpoint:!0,writeTargetCheckpoint:!1}:"target"===n.checkpoint?{writeSourceCheckpoint:!1,writeTargetCheckpoint:!0}:{writeSourceCheckpoint:!0,writeTargetCheckpoint:!0})})}function I(){if(D=[],0!==a.docs.length){var h=a.docs;return t.bulkDocs({docs:h,new_edits:!1},{timeout:n.timeout}).then(function(C){if(r.cancelled)throw ue(),new Error("cancelled");var R=Object.create(null);C.forEach(function(W){W.error&&(R[W.id]=W)});var j=Object.keys(R).length;i.doc_write_failures+=j,i.docs_written+=h.length-j,h.forEach(function(W){var oe=R[W._id];if(oe){i.errors.push(oe);var X=(oe.name||"").toLowerCase();if("unauthorized"!==X&&"forbidden"!==X)throw oe;r.emit("denied",z(oe))}else D.push(W)})},function(C){throw i.doc_write_failures+=h.length,C})}}function V(){if(a.error)throw new Error("There was a problem getting docs.");i.last_seq=T=a.seq;var h=z(i);return D.length&&(h.docs=D,"number"==typeof a.pending&&(h.pending=a.pending,delete a.pending),r.emit("change",h)),l=!0,e.info().then(function(p){var C=e.activeTasks.get(B);if(a&&C){var R=C.completed_items||0,j=parseInt(p.update_seq,10)-parseInt(E,10);e.activeTasks.update(B,{completed_items:R+a.changes.length,total_items:j})}}),x.writeCheckpoint(a.seq,L).then(function(){if(r.emit("checkpoint",{checkpoint:a.seq}),l=!1,r.cancelled)throw ue(),new Error("cancelled");a=void 0,ae()}).catch(function(p){throw we(p),p})}function M(){return function Aa(e,t,n,r){n=z(n);var i=[],s=!0;return Promise.resolve().then(function a(){var l=function ba(e){var t=[];return Object.keys(e).forEach(function(n){e[n].missing.forEach(function(i){t.push({id:n,rev:i})})}),{docs:t,revs:!0,latest:!0}}(n);if(l.docs.length)return e.bulkGet(l).then(function(w){if(r.cancelled)throw new Error("cancelled");return Promise.all(w.results.map(function(b){return Promise.all(b.docs.map(function(E){var T=E.ok;return E.error&&(s=!1),T&&T._attachments?function wa(e,t,n){var r=Ve(t)&&!Ve(e),i=Object.keys(n._attachments);return r?e.get(n._id).then(function(s){return Promise.all(i.map(function(a){return function ma(e,t,n){return!e._attachments||!e._attachments[n]||e._attachments[n].digest!==t._attachments[n].digest}(s,n,a)?t.getAttachment(n._id,a):e.getAttachment(s._id,a)}))}).catch(function(s){if(404!==s.status)throw s;return Lr(t,n)}):Lr(t,n)}(t,e,T).then(g=>{var m=Object.keys(T._attachments);return g.forEach(function(y,d){var _=T._attachments[m[d]];delete _.stub,delete _.length,_.data=y}),T}):T}))})).then(function(b){i=i.concat(b.flat().filter(Boolean))})})}).then(function u(){return{ok:s,docs:i}})}(e,t,a.diffs,r).then(function(h){a.error=!h.ok,h.docs.forEach(function(p){delete a.diffs[p._id],i.docs_read++,a.docs.push(p)})})}function Y(){if(!r.cancelled&&!a){if(0===s.length)return void se(!0);a=s.shift(),r.emit("checkpoint",{start_next_batch:a.seq}),function F(){var h={};return a.changes.forEach(function(p){r.emit("checkpoint",{revs_diff:p}),"_user/"!==p.id&&(h[p.id]=p.changes.map(function(C){return C.rev}))}),t.revsDiff(h).then(function(p){if(r.cancelled)throw ue(),new Error("cancelled");a.diffs=p})}().then(M).then(I).then(V).then(Y).catch(function(h){Z("batch processing terminated with error",h)})}}function se(h){0!==u.changes.length?(h||w||u.changes.length>=m)&&(s.push(u),u={seq:0,changes:[],docs:[]},("pending"===r.state||"stopped"===r.state)&&(r.state="active",r.emit("active")),Y()):0===s.length&&!a&&((g&&P.live||w)&&(r.state="pending",r.emit("paused")),w&&ue())}function Z(h,p){b||(p.message||(p.message=h),i.ok=!1,i.status="aborting",s=[],u={seq:0,changes:[],docs:[]},ue(p))}function ue(h){if(!(b||r.cancelled&&(i.status="cancelled",l)))if(i.status=i.status||"complete",i.end_time=(new Date).toISOString(),i.last_seq=T,b=!0,e.activeTasks.remove(B,h),h){(h=ee(h)).result=i;var p=(h.name||"").toLowerCase();"unauthorized"===p||"forbidden"===p?(r.emit("error",h),r.removeAllListeners()):function Ca(e,t,n,r){if(!1===e.retry)return t.emit("error",n),void t.removeAllListeners();if("function"!=typeof e.back_off_function&&(e.back_off_function=Wr),t.emit("requestError",n),"active"===t.state||"pending"===t.state){t.emit("paused",n),t.state="stopped";var i=function(){e.current_back_off=Kr};t.once("paused",function(){t.removeListener("active",i)}),t.once("active",i)}e.current_back_off=e.current_back_off||Kr,e.current_back_off=e.back_off_function(e.current_back_off),setTimeout(r,e.current_back_off)}(n,r,h,function(){Ur(e,t,n,r)})}else r.emit("complete",i),r.removeAllListeners()}function Ee(h,p,C){if(r.cancelled)return ue();if("number"==typeof p&&(u.pending=p),Qt(n)(h))u.seq=h.seq||C,u.changes.push(h),r.emit("checkpoint",{pending_batch:u.seq}),Ze(function(){se(0===s.length&&P.live)});else{var j=e.activeTasks.get(B);if(j){var W=j.completed_items||0;e.activeTasks.update(B,{completed_items:++W})}}}function Ye(h){if(_=!1,r.cancelled)return ue();if(h.results.length>0)P.since=h.results[h.results.length-1].seq,ae(),se(!0);else{var p=function(){g?(P.live=!0,ae()):w=!0,se(!0)};a||0!==h.results.length?p():(l=!0,x.writeCheckpoint(h.last_seq,L).then(function(){if(l=!1,i.last_seq=T=h.last_seq,r.cancelled)throw ue(),new Error("cancelled");p()}).catch(we))}}function Q(h){if(_=!1,r.cancelled)return ue();Z("changes rejected",h)}function ae(){if(!_&&!w&&s.length<y){_=!0,r._changes&&(r.removeListener("cancel",r._abortChanges),r._changes.cancel()),r.once("cancel",h);var C=e.changes(P).on("change",Ee);C.then(p,p),C.then(Ye).catch(Q),n.retry&&(r._changes=C,r._abortChanges=h)}function h(){C.cancel()}function p(){r.removeListener("cancel",h)}}function he(h){return e.info().then(function(p){var C=typeof n.since>"u"?parseInt(p.update_seq,10)-parseInt(h,10):parseInt(p.update_seq,10);return B=e.activeTasks.add({name:`${g?"continuous ":""}replication from ${p.db_name}`,total_items:C}),h})}function xe(){$().then(function(){if(!r.cancelled)return x.getCheckpoint().then(he).then(function(h){E=h,P={since:T=h,limit:m,batch_size:m,style:d,doc_ids:A,selector:S,return_docs:!0},n.filter&&("string"!=typeof n.filter?P.include_docs=!0:P.filter=n.filter),"heartbeat"in n&&(P.heartbeat=n.heartbeat),"timeout"in n&&(P.timeout=n.timeout),n.query_params&&(P.query_params=n.query_params),n.view&&(P.view=n.view),ae()});ue()}).catch(function(h){Z("getCheckpoint rejected with ",h)})}function we(h){l=!1,Z("writeCheckpoint completed with error",h)}r.ready(e,t),r.cancelled?ue():(r._addedListeners||(r.once("cancel",ue),"function"==typeof n.complete&&(r.once("error",n.complete),r.once("complete",function(h){n.complete(null,h)})),r._addedListeners=!0),typeof n.since>"u"?xe():$().then(function(){return l=!0,x.writeCheckpoint(n.since,L)}).then(function(){l=!1,r.cancelled?ue():(T=n.since,xe())}).catch(we))}class qa extends(v()){constructor(){super(),this.cancelled=!1,this.state="pending";const t=new Promise((n,r)=>{this.once("complete",n),this.once("error",r)});this.then=function(n,r){return t.then(n,r)},this.catch=function(n){return t.catch(n)},this.catch(function(){})}cancel(){this.cancelled=!0,this.state="cancelled",this.emit("cancel")}ready(t,n){if(this._readyCalled)return;this._readyCalled=!0;const r=()=>{this.cancel()};function i(){t.removeListener("destroyed",r),n.removeListener("destroyed",r)}t.once("destroyed",r),n.once("destroyed",r),this.once("complete",i),this.once("error",i)}}function Ft(e,t){return"string"==typeof e?new(0,t.PouchConstructor)(e,t):e}function Pn(e,t,n,r){if("function"==typeof n&&(r=n,n={}),typeof n>"u"&&(n={}),n.doc_ids&&!Array.isArray(n.doc_ids))throw ee(Dt,"`doc_ids` filter parameter is not a list.");n.complete=r,(n=z(n)).continuous=n.continuous||n.live,n.retry="retry"in n&&n.retry,n.PouchConstructor=n.PouchConstructor||this;var i=new qa(n);return Ur(Ft(e,n),Ft(t,n),n,i),i}function Da(e,t,n,r){return"function"==typeof n&&(r=n,n={}),typeof n>"u"&&(n={}),(n=z(n)).PouchConstructor=n.PouchConstructor||this,e=Ft(e,n),t=Ft(t,n),new ka(e,t,n,r)}class ka extends(v()){constructor(t,n,r,i){super(),this.canceled=!1;const s=r.push?Object.assign({},r,r.push):r,a=r.pull?Object.assign({},r,r.pull):r;this.push=Pn(t,n,s),this.pull=Pn(n,t,a),this.pushPaused=!0,this.pullPaused=!0;const u=S=>{this.emit("change",{direction:"pull",change:S})},l=S=>{this.emit("change",{direction:"push",change:S})},w=S=>{this.emit("denied",{direction:"push",doc:S})},b=S=>{this.emit("denied",{direction:"pull",doc:S})},E=()=>{this.pushPaused=!0,this.pullPaused&&this.emit("paused")},T=()=>{this.pullPaused=!0,this.pushPaused&&this.emit("paused")},g=()=>{this.pushPaused=!1,this.pullPaused&&this.emit("active",{direction:"push"})},m=()=>{this.pullPaused=!1,this.pushPaused&&this.emit("active",{direction:"pull"})};let y={};const d=S=>(q,x)=>{("change"===q&&(x===u||x===l)||"denied"===q&&(x===b||x===w)||"paused"===q&&(x===T||x===E)||"active"===q&&(x===m||x===g))&&(q in y||(y[q]={}),y[q][S]=!0,2===Object.keys(y[q]).length&&this.removeAllListeners(q))};function _(S,q,x){-1==S.listeners(q).indexOf(x)&&S.on(q,x)}r.live&&(this.push.on("complete",this.pull.cancel.bind(this.pull)),this.pull.on("complete",this.push.cancel.bind(this.push))),this.on("newListener",function(S){"change"===S?(_(this.pull,"change",u),_(this.push,"change",l)):"denied"===S?(_(this.pull,"denied",b),_(this.push,"denied",w)):"active"===S?(_(this.pull,"active",m),_(this.push,"active",g)):"paused"===S&&(_(this.pull,"paused",T),_(this.push,"paused",E))}),this.on("removeListener",function(S){"change"===S?(this.pull.removeListener("change",u),this.push.removeListener("change",l)):"denied"===S?(this.pull.removeListener("denied",b),this.push.removeListener("denied",w)):"active"===S?(this.pull.removeListener("active",m),this.push.removeListener("active",g)):"paused"===S&&(this.pull.removeListener("paused",T),this.push.removeListener("paused",E))}),this.pull.on("removeListener",d("pull")),this.push.on("removeListener",d("push"));const A=Promise.all([this.push,this.pull]).then(S=>{const q={push:S[0],pull:S[1]};return this.emit("complete",q),i&&i(null,q),this.removeAllListeners(),q},S=>{if(this.cancel(),i?i(S):this.emit("error",S),this.removeAllListeners(),i)throw S});this.then=function(S,q){return A.then(S,q)},this.catch=function(S){return A.catch(S)}}cancel(){this.canceled||(this.canceled=!0,this.push.cancel(),this.pull.cancel())}}ne.plugin(function Qs(e){e.adapter("idb",Ar,!0)}).plugin(function ta(e){e.adapter("http",Sn,!1),e.adapter("https",Sn,!1)}).plugin(ya).plugin(function Ta(e){e.replicate=Pn,e.sync=Da,Object.defineProperty(e.prototype,"replicate",{get:function(){var t=this;return typeof this.replicateMethods>"u"&&(this.replicateMethods={from:function(n,r,i){return t.constructor.replicate(n,t,r,i)},to:function(n,r,i){return t.constructor.replicate(t,n,r,i)}}),this.replicateMethods}}),e.prototype.sync=function(t,n,r){return this.constructor.sync(this,t,n,r)}});const Ra=ne;var Pa=ve(3953);let La=(()=>{var e;class t{constructor(){this.db=new Ra("dailyFinance")}addRecord(r,i,s){var a=this;return(0,G.A)(function*(){const u=s.reduce((b,E)=>b+E.value,0),w={_id:r,date:r,income:i,expenses:s,total:i-u};try{yield a.db.put(w),console.log("Record saved successfully!")}catch(b){throw console.error("Error saving record:",b),b}})()}getRecord(r){var i=this;return(0,G.A)(function*(){try{return yield i.db.get(r)}catch(s){throw console.error("Error retrieving record:",s),s}})()}updateRecord(r,i,s){var a=this;return(0,G.A)(function*(){try{const u=yield a.getRecord(r);u&&(yield a.db.remove(u),console.log("Old record deleted successfully.")),yield a.addRecord(r,i,s),console.log("New record added successfully!")}catch(u){throw console.error("Error updating record:",u),u}})()}}return(e=t).\u0275fac=function(r){return new(r||e)},e.\u0275prov=Pa.jDH({token:e,factory:e.\u0275fac,providedIn:"root"}),t})()},4356:it=>{"use strict";var G,Be="object"==typeof Reflect?Reflect:null,ve=Be&&"function"==typeof Be.apply?Be.apply:function(c,f,N){return Function.prototype.apply.call(c,f,N)};G=Be&&"function"==typeof Be.ownKeys?Be.ownKeys:Object.getOwnPropertySymbols?function(c){return Object.getOwnPropertyNames(c).concat(Object.getOwnPropertySymbols(c))}:function(c){return Object.getOwnPropertyNames(c)};var te=Number.isNaN||function(c){return c!=c};function U(){U.init.call(this)}it.exports=U,it.exports.once=function k(o,c){return new Promise(function(f,N){function J(ie){o.removeListener(c,z),N(ie)}function z(){"function"==typeof o.removeListener&&o.removeListener("error",J),f([].slice.call(arguments))}v(o,c,z,{once:!0}),"error"!==c&&function O(o,c,f){"function"==typeof o.on&&v(o,"error",c,f)}(o,J,{once:!0})})},U.EventEmitter=U,U.prototype._events=void 0,U.prototype._eventsCount=0,U.prototype._maxListeners=void 0;var be=10;function le(o){if("function"!=typeof o)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof o)}function Re(o){return void 0===o._maxListeners?U.defaultMaxListeners:o._maxListeners}function je(o,c,f,N){var J,z,ie;if(le(f),void 0===(z=o._events)?(z=o._events=Object.create(null),o._eventsCount=0):(void 0!==z.newListener&&(o.emit("newListener",c,f.listener?f.listener:f),z=o._events),ie=z[c]),void 0===ie)ie=z[c]=f,++o._eventsCount;else if("function"==typeof ie?ie=z[c]=N?[f,ie]:[ie,f]:N?ie.unshift(f):ie.push(f),(J=Re(o))>0&&ie.length>J&&!ie.warned){ie.warned=!0;var Me=new Error("Possible EventEmitter memory leak detected. "+ie.length+" "+String(c)+" listeners added. Use emitter.setMaxListeners() to increase limit");Me.name="MaxListenersExceededWarning",Me.emitter=o,Me.type=c,Me.count=ie.length,function me(o){console&&console.warn&&console.warn(o)}(Me)}return o}function ge(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function _e(o,c,f){var N={fired:!1,wrapFn:void 0,target:o,type:c,listener:f},J=ge.bind(N);return J.listener=f,N.wrapFn=J,J}function Pe(o,c,f){var N=o._events;if(void 0===N)return[];var J=N[c];return void 0===J?[]:"function"==typeof J?f?[J.listener||J]:[J]:f?function ce(o){for(var c=new Array(o.length),f=0;f<c.length;++f)c[f]=o[f].listener||o[f];return c}(J):Fe(J,J.length)}function $e(o){var c=this._events;if(void 0!==c){var f=c[o];if("function"==typeof f)return 1;if(void 0!==f)return f.length}return 0}function Fe(o,c){for(var f=new Array(c),N=0;N<c;++N)f[N]=o[N];return f}function v(o,c,f,N){if("function"==typeof o.on)N.once?o.once(c,f):o.on(c,f);else{if("function"!=typeof o.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof o);o.addEventListener(c,function J(z){N.once&&o.removeEventListener(c,J),f(z)})}}Object.defineProperty(U,"defaultMaxListeners",{enumerable:!0,get:function(){return be},set:function(o){if("number"!=typeof o||o<0||te(o))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+o+".");be=o}}),U.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},U.prototype.setMaxListeners=function(c){if("number"!=typeof c||c<0||te(c))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+c+".");return this._maxListeners=c,this},U.prototype.getMaxListeners=function(){return Re(this)},U.prototype.emit=function(c){for(var f=[],N=1;N<arguments.length;N++)f.push(arguments[N]);var J="error"===c,z=this._events;if(void 0!==z)J=J&&void 0===z.error;else if(!J)return!1;if(J){var ie;if(f.length>0&&(ie=f[0]),ie instanceof Error)throw ie;var Me=new Error("Unhandled error."+(ie?" ("+ie.message+")":""));throw Me.context=ie,Me}var st=z[c];if(void 0===st)return!1;if("function"==typeof st)ve(st,this,f);else{var Se=st.length,at=Fe(st,Se);for(N=0;N<Se;++N)ve(at[N],this,f)}return!0},U.prototype.on=U.prototype.addListener=function(c,f){return je(this,c,f,!1)},U.prototype.prependListener=function(c,f){return je(this,c,f,!0)},U.prototype.once=function(c,f){return le(f),this.on(c,_e(this,c,f)),this},U.prototype.prependOnceListener=function(c,f){return le(f),this.prependListener(c,_e(this,c,f)),this},U.prototype.off=U.prototype.removeListener=function(c,f){var N,J,z,ie,Me;if(le(f),void 0===(J=this._events))return this;if(void 0===(N=J[c]))return this;if(N===f||N.listener===f)0==--this._eventsCount?this._events=Object.create(null):(delete J[c],J.removeListener&&this.emit("removeListener",c,N.listener||f));else if("function"!=typeof N){for(z=-1,ie=N.length-1;ie>=0;ie--)if(N[ie]===f||N[ie].listener===f){Me=N[ie].listener,z=ie;break}if(z<0)return this;0===z?N.shift():function ze(o,c){for(;c+1<o.length;c++)o[c]=o[c+1];o.pop()}(N,z),1===N.length&&(J[c]=N[0]),void 0!==J.removeListener&&this.emit("removeListener",c,Me||f)}return this},U.prototype.removeAllListeners=function(c){var f,N,J;if(void 0===(N=this._events))return this;if(void 0===N.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==N[c]&&(0==--this._eventsCount?this._events=Object.create(null):delete N[c]),this;if(0===arguments.length){var ie,z=Object.keys(N);for(J=0;J<z.length;++J)"removeListener"!==(ie=z[J])&&this.removeAllListeners(ie);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(f=N[c]))this.removeListener(c,f);else if(void 0!==f)for(J=f.length-1;J>=0;J--)this.removeListener(c,f[J]);return this},U.prototype.listeners=function(c){return Pe(this,c,!0)},U.prototype.rawListeners=function(c){return Pe(this,c,!1)},U.listenerCount=function(o,c){return"function"==typeof o.listenerCount?o.listenerCount(c):$e.call(o,c)},U.prototype.listenerCount=$e,U.prototype.eventNames=function(){return this._eventsCount>0?G(this._events):[]}},4844:it=>{it.exports=function(){"use strict";var G=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];function te(k,O){var v=k[0],o=k[1],c=k[2],f=k[3];o=((o+=((c=((c+=((f=((f+=((v=((v+=(o&c|~o&f)+O[0]-680876936|0)<<7|v>>>25)+o|0)&o|~v&c)+O[1]-389564586|0)<<12|f>>>20)+v|0)&v|~f&o)+O[2]+606105819|0)<<17|c>>>15)+f|0)&f|~c&v)+O[3]-1044525330|0)<<22|o>>>10)+c|0,o=((o+=((c=((c+=((f=((f+=((v=((v+=(o&c|~o&f)+O[4]-176418897|0)<<7|v>>>25)+o|0)&o|~v&c)+O[5]+1200080426|0)<<12|f>>>20)+v|0)&v|~f&o)+O[6]-1473231341|0)<<17|c>>>15)+f|0)&f|~c&v)+O[7]-45705983|0)<<22|o>>>10)+c|0,o=((o+=((c=((c+=((f=((f+=((v=((v+=(o&c|~o&f)+O[8]+1770035416|0)<<7|v>>>25)+o|0)&o|~v&c)+O[9]-1958414417|0)<<12|f>>>20)+v|0)&v|~f&o)+O[10]-42063|0)<<17|c>>>15)+f|0)&f|~c&v)+O[11]-1990404162|0)<<22|o>>>10)+c|0,o=((o+=((c=((c+=((f=((f+=((v=((v+=(o&c|~o&f)+O[12]+1804603682|0)<<7|v>>>25)+o|0)&o|~v&c)+O[13]-40341101|0)<<12|f>>>20)+v|0)&v|~f&o)+O[14]-1502002290|0)<<17|c>>>15)+f|0)&f|~c&v)+O[15]+1236535329|0)<<22|o>>>10)+c|0,o=((o+=((c=((c+=((f=((f+=((v=((v+=(o&f|c&~f)+O[1]-165796510|0)<<5|v>>>27)+o|0)&c|o&~c)+O[6]-1069501632|0)<<9|f>>>23)+v|0)&o|v&~o)+O[11]+643717713|0)<<14|c>>>18)+f|0)&v|f&~v)+O[0]-373897302|0)<<20|o>>>12)+c|0,o=((o+=((c=((c+=((f=((f+=((v=((v+=(o&f|c&~f)+O[5]-701558691|0)<<5|v>>>27)+o|0)&c|o&~c)+O[10]+38016083|0)<<9|f>>>23)+v|0)&o|v&~o)+O[15]-660478335|0)<<14|c>>>18)+f|0)&v|f&~v)+O[4]-405537848|0)<<20|o>>>12)+c|0,o=((o+=((c=((c+=((f=((f+=((v=((v+=(o&f|c&~f)+O[9]+568446438|0)<<5|v>>>27)+o|0)&c|o&~c)+O[14]-1019803690|0)<<9|f>>>23)+v|0)&o|v&~o)+O[3]-187363961|0)<<14|c>>>18)+f|0)&v|f&~v)+O[8]+1163531501|0)<<20|o>>>12)+c|0,o=((o+=((c=((c+=((f=((f+=((v=((v+=(o&f|c&~f)+O[13]-1444681467|0)<<5|v>>>27)+o|0)&c|o&~c)+O[2]-51403784|0)<<9|f>>>23)+v|0)&o|v&~o)+O[7]+1735328473|0)<<14|c>>>18)+f|0)&v|f&~v)+O[12]-1926607734|0)<<20|o>>>12)+c|0,o=((o+=((c=((c+=((f=((f+=((v=((v+=(o^c^f)+O[5]-378558|0)<<4|v>>>28)+o|0)^o^c)+O[8]-2022574463|0)<<11|f>>>21)+v|0)^v^o)+O[11]+1839030562|0)<<16|c>>>16)+f|0)^f^v)+O[14]-35309556|0)<<23|o>>>9)+c|0,o=((o+=((c=((c+=((f=((f+=((v=((v+=(o^c^f)+O[1]-1530992060|0)<<4|v>>>28)+o|0)^o^c)+O[4]+1272893353|0)<<11|f>>>21)+v|0)^v^o)+O[7]-155497632|0)<<16|c>>>16)+f|0)^f^v)+O[10]-1094730640|0)<<23|o>>>9)+c|0,o=((o+=((c=((c+=((f=((f+=((v=((v+=(o^c^f)+O[13]+681279174|0)<<4|v>>>28)+o|0)^o^c)+O[0]-358537222|0)<<11|f>>>21)+v|0)^v^o)+O[3]-722521979|0)<<16|c>>>16)+f|0)^f^v)+O[6]+76029189|0)<<23|o>>>9)+c|0,o=((o+=((c=((c+=((f=((f+=((v=((v+=(o^c^f)+O[9]-640364487|0)<<4|v>>>28)+o|0)^o^c)+O[12]-421815835|0)<<11|f>>>21)+v|0)^v^o)+O[15]+530742520|0)<<16|c>>>16)+f|0)^f^v)+O[2]-995338651|0)<<23|o>>>9)+c|0,o=((o+=((f=((f+=(o^((v=((v+=(c^(o|~f))+O[0]-198630844|0)<<6|v>>>26)+o|0)|~c))+O[7]+1126891415|0)<<10|f>>>22)+v|0)^((c=((c+=(v^(f|~o))+O[14]-1416354905|0)<<15|c>>>17)+f|0)|~v))+O[5]-57434055|0)<<21|o>>>11)+c|0,o=((o+=((f=((f+=(o^((v=((v+=(c^(o|~f))+O[12]+1700485571|0)<<6|v>>>26)+o|0)|~c))+O[3]-1894986606|0)<<10|f>>>22)+v|0)^((c=((c+=(v^(f|~o))+O[10]-1051523|0)<<15|c>>>17)+f|0)|~v))+O[1]-2054922799|0)<<21|o>>>11)+c|0,o=((o+=((f=((f+=(o^((v=((v+=(c^(o|~f))+O[8]+1873313359|0)<<6|v>>>26)+o|0)|~c))+O[15]-30611744|0)<<10|f>>>22)+v|0)^((c=((c+=(v^(f|~o))+O[6]-1560198380|0)<<15|c>>>17)+f|0)|~v))+O[13]+1309151649|0)<<21|o>>>11)+c|0,o=((o+=((f=((f+=(o^((v=((v+=(c^(o|~f))+O[4]-145523070|0)<<6|v>>>26)+o|0)|~c))+O[11]-1120210379|0)<<10|f>>>22)+v|0)^((c=((c+=(v^(f|~o))+O[2]+718787259|0)<<15|c>>>17)+f|0)|~v))+O[9]-343485551|0)<<21|o>>>11)+c|0,k[0]=v+k[0]|0,k[1]=o+k[1]|0,k[2]=c+k[2]|0,k[3]=f+k[3]|0}function U(k){var v,O=[];for(v=0;v<64;v+=4)O[v>>2]=k.charCodeAt(v)+(k.charCodeAt(v+1)<<8)+(k.charCodeAt(v+2)<<16)+(k.charCodeAt(v+3)<<24);return O}function be(k){var v,O=[];for(v=0;v<64;v+=4)O[v>>2]=k[v]+(k[v+1]<<8)+(k[v+2]<<16)+(k[v+3]<<24);return O}function le(k){var o,c,f,N,J,z,O=k.length,v=[1732584193,-271733879,-1732584194,271733878];for(o=64;o<=O;o+=64)te(v,U(k.substring(o-64,o)));for(c=(k=k.substring(o-64)).length,f=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],o=0;o<c;o+=1)f[o>>2]|=k.charCodeAt(o)<<(o%4<<3);if(f[o>>2]|=128<<(o%4<<3),o>55)for(te(v,f),o=0;o<16;o+=1)f[o]=0;return N=(N=8*O).toString(16).match(/(.*?)(.{0,8})$/),J=parseInt(N[2],16),z=parseInt(N[1],16)||0,f[14]=J,f[15]=z,te(v,f),v}function je(k){var v,O="";for(v=0;v<4;v+=1)O+=G[k>>8*v+4&15]+G[k>>8*v&15];return O}function ge(k){var O;for(O=0;O<k.length;O+=1)k[O]=je(k[O]);return k.join("")}function _e(k){return/[\u0080-\uFFFF]/.test(k)&&(k=unescape(encodeURIComponent(k))),k}function ze(k){var o,O=[],v=k.length;for(o=0;o<v-1;o+=2)O.push(parseInt(k.substr(o,2),16));return String.fromCharCode.apply(String,O)}function ce(){this.reset()}return ge(le("hello")),typeof ArrayBuffer<"u"&&!ArrayBuffer.prototype.slice&&function(){function k(O,v){return(O=0|O||0)<0?Math.max(O+v,0):Math.min(O,v)}ArrayBuffer.prototype.slice=function(O,v){var N,J,z,ie,o=this.byteLength,c=k(O,o),f=o;return undefined!==v&&(f=k(v,o)),c>f?new ArrayBuffer(0):(N=f-c,J=new ArrayBuffer(N),z=new Uint8Array(J),ie=new Uint8Array(this,c,N),z.set(ie),J)}}(),ce.prototype.append=function(k){return this.appendBinary(_e(k)),this},ce.prototype.appendBinary=function(k){this._buff+=k,this._length+=k.length;var v,O=this._buff.length;for(v=64;v<=O;v+=64)te(this._hash,U(this._buff.substring(v-64,v)));return this._buff=this._buff.substring(v-64),this},ce.prototype.end=function(k){var o,f,O=this._buff,v=O.length,c=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(o=0;o<v;o+=1)c[o>>2]|=O.charCodeAt(o)<<(o%4<<3);return this._finish(c,v),f=ge(this._hash),k&&(f=ze(f)),this.reset(),f},ce.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},ce.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash.slice()}},ce.prototype.setState=function(k){return this._buff=k.buff,this._length=k.length,this._hash=k.hash,this},ce.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},ce.prototype._finish=function(k,O){var o,c,f,v=O;if(k[v>>2]|=128<<(v%4<<3),v>55)for(te(this._hash,k),v=0;v<16;v+=1)k[v]=0;o=(o=8*this._length).toString(16).match(/(.*?)(.{0,8})$/),c=parseInt(o[2],16),f=parseInt(o[1],16)||0,k[14]=c,k[15]=f,te(this._hash,k)},ce.hash=function(k,O){return ce.hashBinary(_e(k),O)},ce.hashBinary=function(k,O){var o=ge(le(k));return O?ze(o):o},(ce.ArrayBuffer=function(){this.reset()}).prototype.append=function(k){var o,O=function Fe(k,O,v){var o=new Uint8Array(k.byteLength+O.byteLength);return o.set(new Uint8Array(k)),o.set(new Uint8Array(O),k.byteLength),v?o:o.buffer}(this._buff.buffer,k,!0),v=O.length;for(this._length+=k.byteLength,o=64;o<=v;o+=64)te(this._hash,be(O.subarray(o-64,o)));return this._buff=o-64<v?new Uint8Array(O.buffer.slice(o-64)):new Uint8Array(0),this},ce.ArrayBuffer.prototype.end=function(k){var c,f,O=this._buff,v=O.length,o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(c=0;c<v;c+=1)o[c>>2]|=O[c]<<(c%4<<3);return this._finish(o,v),f=ge(this._hash),k&&(f=ze(f)),this.reset(),f},ce.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},ce.ArrayBuffer.prototype.getState=function(){var k=ce.prototype.getState.call(this);return k.buff=function $e(k){return String.fromCharCode.apply(null,new Uint8Array(k))}(k.buff),k},ce.ArrayBuffer.prototype.setState=function(k){return k.buff=function Pe(k,O){var f,v=k.length,o=new ArrayBuffer(v),c=new Uint8Array(o);for(f=0;f<v;f+=1)c[f]=k.charCodeAt(f);return O?c:o}(k.buff,!0),ce.prototype.setState.call(this,k)},ce.ArrayBuffer.prototype.destroy=ce.prototype.destroy,ce.ArrayBuffer.prototype._finish=ce.prototype._finish,ce.ArrayBuffer.hash=function(k,O){var o=ge(function Re(k){var o,c,f,N,J,z,O=k.length,v=[1732584193,-271733879,-1732584194,271733878];for(o=64;o<=O;o+=64)te(v,be(k.subarray(o-64,o)));for(c=(k=o-64<O?k.subarray(o-64):new Uint8Array(0)).length,f=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],o=0;o<c;o+=1)f[o>>2]|=k[o]<<(o%4<<3);if(f[o>>2]|=128<<(o%4<<3),o>55)for(te(v,f),o=0;o<16;o+=1)f[o]=0;return N=(N=8*O).toString(16).match(/(.*?)(.{0,8})$/),J=parseInt(N[2],16),z=parseInt(N[1],16)||0,f[14]=J,f[15]=z,te(v,f),v}(new Uint8Array(k)));return O?ze(o):o},ce}()},9186:(it,Be)=>{"use strict";function ve(G,me,te){var U=te[te.length-1];G===U.element&&(te.pop(),U=te[te.length-1]);var be=U.element,le=U.index;Array.isArray(be)?be.push(G):le===me.length-2?be[me.pop()]=G:me.push(G)}Be.stringify=function(me){var te=[];te.push({obj:me});for(var be,le,je,ge,Pe,$e,Fe,ze,ce,U="";be=te.pop();)if(le=be.obj,U+=be.prefix||"",je=be.val||"")U+=je;else if("object"!=typeof le)U+=typeof le>"u"?null:JSON.stringify(le);else if(null===le)U+="null";else if(Array.isArray(le)){for(te.push({val:"]"}),ge=le.length-1;ge>=0;ge--)te.push({obj:le[ge],prefix:0===ge?"":","});te.push({val:"["})}else{for($e in Pe=[],le)le.hasOwnProperty($e)&&Pe.push($e);for(te.push({val:"}"}),ge=Pe.length-1;ge>=0;ge--)ze=le[Fe=Pe[ge]],ce=ge>0?",":"",ce+=JSON.stringify(Fe)+":",te.push({obj:ze,prefix:ce});te.push({val:"{"})}return U},Be.parse=function(G){for(var be,le,Re,je,ge,_e,Pe,$e,Fe,me=[],te=[],U=0;;)if("}"===(be=G[U++])||"]"===be||typeof be>"u"){if(1===me.length)return me.pop();ve(me.pop(),me,te)}else switch(be){case" ":case"\t":case"\n":case":":case",":break;case"n":U+=3,ve(null,me,te);break;case"t":U+=3,ve(!0,me,te);break;case"f":U+=4,ve(!1,me,te);break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"-":for(le="",U--;;){if(Re=G[U++],!/[\d\.\-e\+]/.test(Re)){U--;break}le+=Re}ve(parseFloat(le),me,te);break;case'"':for(je="",ge=void 0,_e=0;'"'!==(Pe=G[U++])||"\\"===ge&&_e%2==1;)je+=Pe,"\\"===(ge=Pe)?_e++:_e=0;ve(JSON.parse('"'+je+'"'),me,te);break;case"[":me.push(($e={element:[],index:me.length}).element),te.push($e);break;case"{":me.push((Fe={element:{},index:me.length}).element),te.push(Fe);break;default:throw new Error("unexpectedly reached end of input: "+be)}}}}]);